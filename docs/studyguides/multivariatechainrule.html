<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Donald Campbell">

<title>Multivariate chain rule – STARMAST</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-aa1d8570cb8b85794c5c5a916513ecb9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-5f5484d7ec656626cab3b40347c418b2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-aa1d8570cb8b85794c5c5a916513ecb9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-L30GVCTC8L"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-L30GVCTC8L', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":"",
"website_privacy_policy_url":"cookies.qmd"
  ,
"language":"en"
  });
});
</script> 
  
<script>
  window.addEventListener('load', function() {
    document.getElementById("cc-nb-title").innerHTML = "Your privacy is important to us";
    document.getElementById("cc-nb-text").innerHTML = "This website uses Google Analytics to measure traffic to and from the site, and to learn where our users come from. We use cookies to enable this service, alongside enabling our non-identifiable QuickCheck problem tracking. These are the sole purposes of enabling cookies on this website.";
  });
</script>

<script src="https://www.desmos.com/api/v1.11/calculator.js?apiKey=2949896c7db64d4a8a380b1e11254b5f"></script>
<script src="https://esm.sh/shinylive-r"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../webexfiles/webex.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo-big.png" alt="" class="navbar-logo light-content">
    <img src="../logo-big.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STARMAST</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../newsindex.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../fullindex.html"> 
<span class="menu-text">Full index</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <div id="quarto-announcement" data-announcement-id="78946bb30c4840548b707679e0eb265d" class="alert alert-danger hidden"><i class="bi bi-database-add quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Latest content:</strong> Celebrating over 600 active users since launch - thank you for all your support! (01/12/25)</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-the-multivariate-chain-rule" id="toc-what-is-the-multivariate-chain-rule" class="nav-link active" data-scroll-target="#what-is-the-multivariate-chain-rule">What is the multivariate chain rule?</a></li>
  <li><a href="#dependent-and-independent-variables" id="toc-dependent-and-independent-variables" class="nav-link" data-scroll-target="#dependent-and-independent-variables">Dependent and independent variables</a></li>
  <li><a href="#functions-of-two-dependent-variables-with-one-independent-variable" id="toc-functions-of-two-dependent-variables-with-one-independent-variable" class="nav-link" data-scroll-target="#functions-of-two-dependent-variables-with-one-independent-variable">Functions of two dependent variables with one independent variable</a></li>
  <li><a href="#functions-of-two-dependent-variables-with-two-independent-variables" id="toc-functions-of-two-dependent-variables-with-two-independent-variables" class="nav-link" data-scroll-target="#functions-of-two-dependent-variables-with-two-independent-variables">Functions of two dependent variables with two independent variables</a></li>
  <li><a href="#generalized-multivariate-chain-rule" id="toc-generalized-multivariate-chain-rule" class="nav-link" data-scroll-target="#generalized-multivariate-chain-rule">Generalized multivariate chain rule</a></li>
  <li><a href="#tree-representation-of-the-multivariate-chain-rule" id="toc-tree-representation-of-the-multivariate-chain-rule" class="nav-link" data-scroll-target="#tree-representation-of-the-multivariate-chain-rule">Tree representation of the multivariate chain rule</a></li>
  <li><a href="#quick-check-problems" id="toc-quick-check-problems" class="nav-link" data-scroll-target="#quick-check-problems">Quick check problems</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading">Further reading</a>
  <ul class="collapse">
  <li><a href="#version-history" id="toc-version-history" class="nav-link" data-scroll-target="#version-history">Version history</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="multivariatechainrule.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="multivariatechainrule.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multivariate chain rule</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Calculus</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Donald Campbell </p>
          </div>
  </div>
    
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Summary</div>
    The multivariate chain rule is used in calculus to differentiate a function when its variables depend on other variables. It shows how the change in one variable affects the whole function by considering how the intermediate variables change. It is useful in modelling systems where one quantity depends on several factors.
  </div>
</div>


</header>


<p><em>Before reading this guide, it is recommended that you read <a href="../studyguides/introtopartialdifferentiation.html">Guide: Introduction to partial differentiation</a> and <a href="../studyguides/chainrule.html">Guide: The chain rule</a>.</em></p>
<table><tbody><tr><td style="vertical-align: middle"><strong>Narration of study guide:</strong>&nbsp;&nbsp;</td><td><audio controls=""><source src="./Narrations/multivariatechainrule.mp3" type="audio/mpeg">Your browser does not support the audio element.</audio></td></tr></tbody></table>
<section id="what-is-the-multivariate-chain-rule" class="level1">
<h1>What is the multivariate chain rule?</h1>
<p>As seen in <a href="../studyguides/chainrule.html">Guide: The chain rule</a>, the chain rule tells you how to differentiate a function <span class="math inline">\(y=y(x)\)</span> with respect to another variable <span class="math inline">\(t\)</span> when <span class="math inline">\(x\)</span> depends on <span class="math inline">\(t\)</span>. <span class="math display">\[\dfrac{\mathrm{d}y}{\mathrm{d}t} = \dfrac{\mathrm{d}y}{\mathrm{d}x}\dfrac{\mathrm{d}x}{\mathrm{d}t}\]</span></p>
<p>This rule can be extended to functions of multiple variables through the <strong>multivariate chain rule</strong>. The extended rule tells you how to compute derivatives of composite functions (functions of functions) involving multiple variables. It allows you to track how changes in <strong>independent variables</strong> influence a final quantity through intermediate variables called <strong>dependent variables</strong>.</p>
<p>The multivariate chain rule is used in problems involving parametric multivariate functions, such as those describing motion along curved surfaces, transformations in computer graphics, and population models where growth depends on multiple time-varying factors. Another important example is a climate model: these use variables like temperature, humidity and ocean currents to predict weather patterns.</p>
<p>Before beginning, it is important to understand the difference between dependent and independent variables. From there, the multivariate chain rule accounts for any combination of dependent and independent variables; this guide looks at two dependent variables with one/two independent variables, and then discusses the general case at the very end.</p>
</section>
<section id="dependent-and-independent-variables" class="level1">
<h1>Dependent and independent variables</h1>
<p>When a function <strong>depends</strong> on a specific variable, this means that the function is written with the variable in its rule. For example, the function <span class="math inline">\(f(x,y) = x^2 + y^2\)</span> depends on <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> as the function is written in terms of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>A <strong>multivariate (or multivariable) function</strong> is a function that depends on more than one variable.</p>
<p>Consider a multivariate function <span class="math inline">\(w = w(x,y,z) = 2x^2 + xy + 3xz\)</span> where <span class="math display">\[\begin{aligned}
x(s,t) &amp;= s^2 - t \\[0.2em]
y(s,t) &amp;= s^2 + t \\[0.2em]
z(s,t) &amp;= 2s + t^2
\end{aligned}\]</span></p>
<p>The variables <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> are referred to as <strong>dependent variables</strong> as they are functions that depend on (can be written in terms of) the variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. Even though <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> are referred to as ‘variables’, they are actually functions of the variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. In this case, the dependent variables can be written in functional form as <span class="math inline">\(x = x(s,t)\)</span>, <span class="math inline">\(y = y(s,t)\)</span> and <span class="math inline">\(z = z(s,t)\)</span> to emphasize dependency.</p>
<p>The variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> are referred to as <strong>independent variables</strong> as they do not depend on any other variables.</p>
<p>Occasionally, the dependent variables in this guide may be referred to as <strong>intermediate variables</strong> since they connect the independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> to the final quantity <span class="math inline">\(w\)</span>.</p>
</section>
<section id="functions-of-two-dependent-variables-with-one-independent-variable" class="level1">
<h1>Functions of two dependent variables with one independent variable</h1>
<p>Suppose you have a function <span class="math inline">\(z = z(x,y)\)</span>. Here, <span class="math inline">\(z\)</span> depends on two dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, however both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are functions of a single independent variable <span class="math inline">\(t\)</span>. <span class="math display">\[x=x(t) \quad \textsf{and} \quad y=y(t)\]</span></p>
<p>This means that, even though <span class="math inline">\(z\)</span> initially looks like a function of two dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, it really depends on a single independent variable <span class="math inline">\(t\)</span>. You can write <span class="math inline">\(z\)</span> entirely in terms of <span class="math inline">\(t\)</span>: <span class="math display">\[z = z(x(t),y(t))\]</span></p>
<p>The goal is to find <span class="math inline">\(\dfrac{\mathrm{d}z}{\mathrm{d}t}\)</span>.</p>
<p>You may not be able to differentiate <span class="math inline">\(z = z(x,y)\)</span> directly with respect to <span class="math inline">\(t\)</span> because <span class="math inline">\(z\)</span> depends intermediately on both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Instead, you could use the <strong>multivariate chain rule</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Multivariate chain rule for functions of one independent variable
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(z=z(x,y)\)</span> where <span class="math inline">\(f\)</span> is a differentiable function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Also let <span class="math inline">\(x=x(t)\)</span> and <span class="math inline">\(y=y(t)\)</span> be differentiable functions of <span class="math inline">\(t\)</span>.</p>
<p>The function <span class="math inline">\(z\)</span> can then be differentiated with respect to <span class="math inline">\(t\)</span> according to <span class="math display">\[\dfrac{\mathrm{d}z}{\mathrm{d}t} = \dfrac{\partial z}{\partial x}\dfrac{\mathrm{d}x}{\mathrm{d}t} + \dfrac{\partial z}{\partial y}\dfrac{\mathrm{d}y}{\mathrm{d}t}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The left-most derivative <span class="math inline">\(\dfrac{\mathrm{d}z}{\mathrm{d}t}\)</span> is written with a straight <span class="math inline">\(\mathrm{d}\)</span> as <span class="math inline">\(z= z(x,y) = z(x(t),y(t))\)</span> is ultimately a function of <span class="math inline">\(t\)</span> alone. Here, <span class="math inline">\(z\)</span> is written using the expressions for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in terms of <span class="math inline">\(t\)</span>.</p>
<p>Derivatives such as <span class="math inline">\(\dfrac{\partial z}{\partial x}\)</span> and <span class="math inline">\(\dfrac{\partial z}{\partial y}\)</span> are written with a curly <span class="math inline">\(\partial\)</span> as <span class="math inline">\(z\)</span> is a function that depends on two variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>Derivatives such as <span class="math inline">\(\dfrac{\mathrm{d}x}{\mathrm{d}t}\)</span> and <span class="math inline">\(\dfrac{\mathrm{d}y}{\mathrm{d}t}\)</span> are written with a straight <span class="math inline">\(\mathrm{d}\)</span> as <span class="math inline">\(x\)</span> is a function that depends only on a single variable <span class="math inline">\(t\)</span>.</p>
</div>
</div>
<p>As <span class="math inline">\(t\)</span> changes, both dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> change as they are both functions of the independent variable <span class="math inline">\(t\)</span>. This causes <span class="math inline">\(z\)</span> to change as it is a function of the variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> which are also changing.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example 1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(z = z(x,y) = x^3 + y^3\)</span> where <span class="math inline">\(x=3t^2\)</span> and <span class="math inline">\(y=\cos(t)\)</span>. Use the multivariate chain rule to find <span class="math inline">\(\dfrac{\mathrm{d}z}{\mathrm{d}t}\)</span>.</p>
<p>First, calculate the derivatives required for the multivariate chain rule. <span class="math display">\[\begin{array}{lcl}
\dfrac{\partial z}{\partial x} = 3x^2 &amp; \quad &amp;
\dfrac{\partial z}{\partial y} = 3y^2 \\[0.5em]
\dfrac{\mathrm{d}x}{\mathrm{d}t} = 6t &amp; \quad &amp;
\dfrac{\mathrm{d}y}{\mathrm{d}t} = -\sin(t)
\end{array}\]</span></p>
<p>You then need to substitute the derivatives into the multivariate chain rule, then substitute for <span class="math inline">\(x=3t^2\)</span> and <span class="math inline">\(y=\cos(t)\)</span>. <span class="math display">\[\begin{aligned}
\dfrac{\mathrm{d}z}{\mathrm{d}t} &amp;= \dfrac{\partial z}{\partial x}\dfrac{\mathrm{d}x}{\mathrm{d}t} + \dfrac{\partial z}{\partial y}\dfrac{\mathrm{d}y}{\mathrm{d}t} \\[0.5em]
&amp;= (3x^2)(6t) + (3y^2)(-\sin(t)) \\[0.5em]
&amp;= 3(3t^2)^2(6t) + 3(\cos(t))^2(-\sin(t)) \\[0.5em]
&amp;= 162t^5 - 3\sin(t)\cos^2(t)
\end{aligned}\]</span> and this is your final answer.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Make sure that your final answer is always expressed only in terms of the <strong>independent variables</strong>. Your final answer should not include any intermediate variables (like <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in this example).</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You could notice that in this case, you could substitute <span class="math inline">\(x = x(t)\)</span> and <span class="math inline">\(y = y(t)\)</span> into the equation and directly differentiate with respect to <span class="math inline">\(t\)</span>. However, this might not be possible in all cases, and usually using the multivariate chain rule will result in cleaner working. For instance, if <span class="math inline">\(z=z(x,y) = xe^{xy}\)</span> with dependent variables <span class="math inline">\(x(t) = t^5 - t^4 + t^3 + 1\)</span> and <span class="math inline">\(y(t) = \cos(t^2)\)</span>, then you can directly substitute and differentiate; but it would be very difficult to do!</p>
</div>
</div>
</section>
<section id="functions-of-two-dependent-variables-with-two-independent-variables" class="level1 unnumbered">
<h1 class="unnumbered">Functions of two dependent variables with two independent variables</h1>
<p>Suppose you have a function <span class="math inline">\(z=z(x,y)\)</span>, where both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are now functions of <strong>two</strong> independent variables. Here, <span class="math inline">\(z\)</span> depends on two dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, however now both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are functions of two independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. <span class="math display">\[x=x(s,t) \quad \textsf{and} \quad y=y(s,t)\]</span></p>
<p>This means that, even though <span class="math inline">\(z\)</span> initially looks like a function of two dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, it really depends on two independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. In fact, you can write <span class="math inline">\(z\)</span> entirely in terms of <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. <span class="math display">\[z = z ( x(s,t), y(s,t) )\]</span></p>
<p>Since there are now two independent variables, the goal is to find both <span class="math inline">\(\dfrac{\partial z}{\partial s}\)</span> and <span class="math inline">\(\dfrac{\partial z}{\partial t}\)</span>.</p>
<p>You cannot differentiate <span class="math inline">\(z = z(x,y)\)</span> directly with respect to <span class="math inline">\(s\)</span> or <span class="math inline">\(t\)</span> because <span class="math inline">\(z\)</span> depends intermediately on both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Instead, you need to use the multivariate chain rule.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Multivariate chain rule for functions of two independent variables
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(z=z(x,y)\)</span> where <span class="math inline">\(f\)</span> is a differentiable function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Also, let <span class="math inline">\(x=x(s,t)\)</span> and <span class="math inline">\(y=y(s,t)\)</span> be differentiable functions of <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>.</p>
<p>The function <span class="math inline">\(z\)</span> can then be differentiated with respect to <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> with <span class="math display">\[\begin{aligned}
\dfrac{\partial z}{\partial s} &amp;= \dfrac{\partial z}{\partial x}\dfrac{\partial x}{\partial s} + \dfrac{\partial z}{\partial y}\dfrac{\partial y}{\partial s} \\[0.5em]
\dfrac{\partial z}{\partial t} &amp;= \dfrac{\partial z}{\partial x}\dfrac{\partial x}{\partial t} + \dfrac{\partial z}{\partial y}\dfrac{\partial y}{\partial t}
\end{aligned}\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The left-most derivatives <span class="math inline">\(\dfrac{\partial z}{\partial s}\)</span> and <span class="math inline">\(\dfrac{\partial z}{\partial t}\)</span> are written with a curly <span class="math inline">\(\partial\)</span> as <span class="math inline">\(z=z(s,t)\)</span> is considered a function of both <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> at this stage. Here, <span class="math inline">\(z\)</span> is written using the expressions for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in terms of <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>.</p>
<p>Notice that the <span class="math inline">\(\dfrac{\partial x}{\partial s}\)</span>, <span class="math inline">\(\dfrac{\partial x}{\partial t}\)</span>, <span class="math inline">\(\dfrac{\partial y}{\partial s}\)</span> and <span class="math inline">\(\dfrac{\partial y}{\partial t}\)</span> derivatives are now written with a curly <span class="math inline">\(\partial\)</span> instead of a straight <span class="math inline">\(\mathrm{d}\)</span> as <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are functions that now depend on two independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. This means the derivatives are now partial derivatives instead of ordinary derivatives.</p>
</div>
</div>
<p>As <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> change, both dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> change as they are both functions of the independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. This causes <span class="math inline">\(z\)</span> to change as it is a function of variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> which are also changing.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example 2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(z = z(x,y) = x^2 + 3xy\)</span> where <span class="math inline">\(x=s+t^2\)</span> and <span class="math inline">\(y=s^2-t\)</span>. Use the multivariate chain rule to find <span class="math inline">\(\dfrac{\partial z}{\partial s}\)</span> and <span class="math inline">\(\dfrac{\partial z}{\partial t}\)</span>.</p>
<p>First, calculate the derivatives required for the multivariate chain rule. <span class="math display">\[\begin{array}{lcl}
\dfrac{\partial z}{\partial x} = 2x + 3y &amp; \quad &amp; \dfrac{\partial z}{\partial y} = 3x \\[0.5em]
\dfrac{\partial x}{\partial s} = 1 &amp; \quad &amp; \dfrac{\partial y}{\partial s} = 2s \\[0.5em]
\dfrac{\partial x}{\partial t} = 2t &amp; \quad &amp; \dfrac{\partial y}{\partial t} = -1
\end{array}\]</span></p>
<p>You need to substitute the partial derivatives into the multivariate chain rule, then substitute for <span class="math inline">\(x=s+t^2\)</span> and <span class="math inline">\(y=s^2-t\)</span>.</p>
<p>Firstly, calculate the partial derivative of <span class="math inline">\(z\)</span> with respect to <span class="math inline">\(s\)</span>: <span class="math display">\[\begin{aligned}
\dfrac{\partial z}{\partial s} &amp;= \dfrac{\partial z}{\partial x}\dfrac{\partial x}{\partial s} + \dfrac{\partial z}{\partial y}\dfrac{\partial y}{\partial s} \\[0.5em]
&amp;= (2x+3y)(1) + (3x)(2s) \\[0.5em]
&amp;= ( 2(s+t^2)+3(s^2-t) ) ( 1 ) + ( 3(s+t^2) ) ( 2s ) \\[0.5em]
&amp;= 9s^2 + 2t^2 + 6st^2 + 2s - 3t
\end{aligned}\]</span></p>
<p>Now, calculate the partial derivative of <span class="math inline">\(z\)</span> with respect to <span class="math inline">\(t\)</span>: <span class="math display">\[\begin{aligned}
\dfrac{\partial z}{\partial t} &amp;= \dfrac{\partial z}{\partial x}\dfrac{\partial x}{\partial t} + \dfrac{\partial z}{\partial y}\dfrac{\partial y}{\partial t} \\[0.5em]
&amp;= (2x+3y)(2t) + (3x)(-1) \\[0.5em]
&amp;= ( 2(s+t^2)+3(s^2-t) ) ( 2t ) + ( 3(s+t^2) ) ( -1 ) \\[0.5em]
&amp;= 4t^3-9t^2+6s^2t-3s+4st
\end{aligned}\]</span></p>
</div>
</div>
</section>
<section id="generalized-multivariate-chain-rule" class="level1">
<h1>Generalized multivariate chain rule</h1>
<p>Suppose you have a function <span class="math inline">\(w = w(x_1, x_2, \ldots , x_n)\)</span>. Here, <span class="math inline">\(w\)</span> depends on <span class="math inline">\(n\)</span> dependent variables <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span> where each of these variables is a function of <span class="math inline">\(m\)</span> independent variables <span class="math inline">\(t_1, t_2, \ldots, t_m\)</span>. <span class="math display">\[\begin{aligned}
x_1 &amp;= x_1(t_1, t_2, \ldots, t_m) \\[0.2em]
x_2 &amp;= x_2(t_1, t_2, \ldots, t_m) \\[0.2em]
\vdots \;\, &amp;= \;\, \vdots \\[0.2em]
x_n &amp;= x_n(t_1, t_2, \ldots, t_m)
\end{aligned}\]</span></p>
<p>The previous cases investigated were <span class="math display">\[\begin{array}{lclclclclcl}
\textsf{Case 1:} &amp; \; &amp; n = 1, &amp; \; &amp; m = 1, &amp; \; &amp; y = y(x), &amp; \; &amp; x = x(t). &amp; \; &amp; \\[0.5em]
\textsf{Case 2:} &amp; \; &amp; n = 2, &amp; \; &amp; m = 1, &amp; \; &amp; z = z(x, y), &amp; \; &amp; x = x(t), &amp; \; &amp; y = y(t). \\[0.5em]
\textsf{Case 3:} &amp; \; &amp; n = 2, &amp; \; &amp; m = 2, &amp; \; &amp; z = z(x, y), &amp; \; &amp; x = x(s, t), &amp; \; &amp; y = y(s, t).
\end{array}\]</span></p>
<p>where:</p>
<ul>
<li><p>Case 1 corresponds to the chain rule for one dependent variable and one independent variable - see <a href="../studyguides/chainrule.html">Guide: The chain rule</a>.</p></li>
<li><p>Case 2 corresponds to the chain rule for two dependent variables and one independent variable.</p></li>
<li><p>Case 3 corresponds to the chain rule for two dependent variables and two independent variables.</p></li>
</ul>
<p>The multivariate chain rule can be generalized as follows.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Generalized multivariate chain rule
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(w = w(x_1, x_2, \ldots , x_n)\)</span> be a differentiable function of <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span>. Also let the following dependent variables be differentiable functions of <span class="math inline">\(t_1, t_2, \ldots, t_m\)</span>. <span class="math display">\[\begin{aligned}
x_1 &amp;= x_1(t_1, t_2, \ldots, t_m) \\[0.2em]
x_2 &amp;= x_2(t_1, t_2, \ldots, t_m) \\[0.2em]
\vdots \;\, &amp;= \;\, \vdots \\[0.2em]
x_n &amp;= x_n(t_1, t_2, \ldots, t_m)
\end{aligned}\]</span></p>
<p>The function <span class="math inline">\(w\)</span> can then be differentiated with respect to <span class="math inline">\(t_1, t_2, \ldots, t_m\)</span> with <span class="math display">\[\begin{aligned}
\dfrac{\partial w}{\partial t_1} &amp;= \sum_{i=1}^n \dfrac{\partial w}{\partial x_i} \dfrac{\partial{x_i}}{\partial {t_1}} = \dfrac{\partial w}{\partial x_1} \dfrac{\partial x_1}{\partial t_1} + \dfrac{\partial w}{\partial x_2} \dfrac{\partial x_2}{\partial t_1} + \ldots + \dfrac{\partial w}{\partial x_n} \dfrac{\partial x_n}{\partial t_1} \\[0.5em]
\dfrac{\partial w}{\partial t_2} &amp;= \sum_{i=1}^n \dfrac{\partial w}{\partial x_i} \dfrac{\partial{x_i}}{\partial {t_2}} = \dfrac{\partial w}{\partial x_1} \dfrac{\partial x_1}{\partial t_2} + \dfrac{\partial w}{\partial x_2} \dfrac{\partial x_2}{\partial t_2} + \ldots + \dfrac{\partial w}{\partial x_n} \dfrac{\partial x_n}{\partial t_2} \\[0.5em]
\vdots \quad\! &amp;= \quad\! \vdots \\[0.5em]
\dfrac{\partial w}{\partial t_m} &amp;= \sum_{i=1}^n \dfrac{\partial w}{\partial x_i} \dfrac{\partial{x_i}}{\partial {t_m}} = \dfrac{\partial w}{\partial x_1} \dfrac{\partial x_1}{\partial t_m} + \dfrac{\partial w}{\partial x_2} \dfrac{\partial x_2}{\partial t_m} + \ldots + \dfrac{\partial w}{\partial x_n} \dfrac{\partial x_n}{\partial t_m}
\end{aligned}\]</span></p>
<p>(where <span class="math inline">\(\sum\)</span> represents <strong>sigma notation</strong>; see <a href="../studyguides/sigmanotation.html">Guide: Sigma notation</a> for more.)</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>A particular case exists where the variables <span class="math inline">\(x_i\)</span> each depend on only one independent variable <span class="math inline">\(x_1 = x_1(t), x_2 = x_2(t), \ldots, x_n = x_n(t)\)</span>. In this case, a straight <span class="math inline">\(\mathrm{d}\)</span> should be used instead of a curly <span class="math inline">\(\partial\)</span>. <span class="math display">\[
\begin{aligned}
\dfrac{\mathrm{d}{w}}{\mathrm{d}{t}} &amp;=\sum_{i=1}^n \dfrac{\partial w}{\partial x_i} \dfrac{\mathrm{d}{x_i}}{\mathrm{d}{t}} = \dfrac{\partial w}{\partial x_1} \dfrac{\mathrm{d}{x_1}}{\mathrm{d}{t}} + \dfrac{\partial w}{\partial x_2} \dfrac{\mathrm{d}{x_2}}{\mathrm{d}{t}} + \ldots + \dfrac{\partial w}{\partial x_n} \dfrac{\mathrm{d}{x_n}}{\mathrm{d}{t}}\\[0.5em]
\end{aligned}
\]</span></p>
<p>Similarly, if there is only one dependent variable <span class="math inline">\(x\)</span>, then a straight <span class="math inline">\(\mathrm{d}\)</span> should be used instead of a curly <span class="math inline">\(\partial\)</span> for the derivatives of <span class="math inline">\(w\)</span> with respect to <span class="math inline">\(x\)</span>.</p>
</div>
</div>
<p>Here’s an example of a case with <span class="math inline">\(n=3\)</span> dependent variables and <span class="math inline">\(m=2\)</span> independent variables.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(w = w(x,y,z) = x^2 -3xz + 2xy\)</span> where <span class="math display">\[\begin{aligned}
x(s,t) &amp;= s^2-t \\
y(s,t) &amp;= s\cos(t) \\
z(s,t) &amp;= t^2-s
\end{aligned}\]</span></p>
<p>Use the multivariate chain rule to find <span class="math inline">\(\dfrac{\partial w}{\partial s}\)</span> and <span class="math inline">\(\dfrac{\partial w}{\partial t}\)</span>.</p>
<p>Firstly, calculate the derivatives required for the multivariate chain rule. <span class="math display">\[\begin{array}{lclcl}
\dfrac{\partial w}{\partial x} = 2x - 3z + 2y &amp; \quad &amp; \dfrac{\partial w}{\partial y} = 2x &amp; \quad &amp; \dfrac{\partial w}{\partial z} = -3x \\[0.5em]
\dfrac{\partial x}{\partial s} = 2s &amp; \quad &amp; \dfrac{\partial y}{\partial s} = \cos(t) &amp; \quad &amp; \dfrac{\partial z}{\partial s} = -1 \\[0.5em]
\dfrac{\partial x}{\partial t} = -1 &amp; \quad &amp; \dfrac{\partial y}{\partial t} = -s\sin(t) &amp; \quad &amp; \dfrac{\partial z}{\partial t} = 2t
\end{array}\]</span></p>
<p>You need to substitute the partial derivatives into the multivariate chain rule, then substitute for <span class="math inline">\(x=s^2-t\)</span>, <span class="math inline">\(y = s\cos(t)\)</span> and <span class="math inline">\(z=t^2-s\)</span>.</p>
<p>You can calculate the partial derivative of <span class="math inline">\(w\)</span> with respect to <span class="math inline">\(s\)</span> as: <span class="math display">\[\begin{aligned}
\dfrac{\partial w}{\partial s} &amp;= \dfrac{\partial w}{\partial x}\dfrac{\partial x}{\partial s} + \dfrac{\partial w}{\partial y}\dfrac{\partial y}{\partial s} + \dfrac{\partial w}{\partial z}\dfrac{\partial z}{\partial s} \\[0.5em]
&amp;= (2x-3z+2y)(2s) + (2x)(\cos(t)) + (-3x)(-1) \\[1em]
&amp;= ( 2(s^2-t)-3(t^2-s)+2s\cos(t) ) ( 2s ) + ( 2(s^2-t) ) ( \cos(t) ) \\
&amp;\phantom{= } \quad + ( -3(s^2-t) ) ( -1 ) \\[1em]
&amp;= 4s^3 + 9s^2 + 6s^2\cos(t) - 4st - 6st^2 - 2t\cos(t) - 3t
\end{aligned}\]</span></p>
<p>You can calculate the partial derivative of <span class="math inline">\(w\)</span> with respect to <span class="math inline">\(t\)</span> as: <span class="math display">\[\begin{aligned}
\dfrac{\partial w}{\partial t} &amp;= \dfrac{\partial w}{\partial x}\dfrac{\partial x}{\partial t} + \dfrac{\partial w}{\partial y}\dfrac{\partial y}{\partial t} + \dfrac{\partial w}{\partial z}\dfrac{\partial z}{\partial t} \\[0.5em]
&amp;= (2x-3z+2y)(-1) + (2x)(-s\sin(t)) + (-3x)(2t) \\[1em]
&amp;= ( 2(s^2-t)-3(t^2-s)+2s\cos(t) ) ( -1 ) \\
&amp;\phantom{= } \quad + ( 2(s^2-t) ) ( -s\sin(t) ) + ( -3(s^2-t) ) ( 2t ) \\[1em]
&amp;= -2s^2 + 9t^2 + 2t - 3s - 2s\cos(t) - 2s^3\sin(t) \\
&amp;\phantom{= } \quad + 2st\sin(t) - 6ts^2
\end{aligned}\]</span></p>
</div>
</div>
</section>
<section id="tree-representation-of-the-multivariate-chain-rule" class="level1">
<h1>Tree representation of the multivariate chain rule</h1>
<p>There is a useful way for determining the required form of the multivariate chain rule without needing to remember the generalized rule above. The following diagram is a <strong>tree representation</strong> of the dependencies between variables in a multivariate function.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="FiguresPNG/multivariatechainrule-fig1-1-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Tree diagram for determining the form of the multivariate chain rule in Example 3.</figcaption>
</figure>
</div>
<p>At the top of the tree is the function <span class="math inline">\(w = w(x,y,z)\)</span>, which depends on three intermediate variables <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span>. Each of these three intermediate variables depend on independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. The tree shows all possible paths from <span class="math inline">\(w\)</span> to the independent variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>.</p>
<p>Each path represents a <strong>chain of partial differentiation</strong> (a product of partial derivatives) when applying the chain rule. All paths are combined by summing these chains at the end to find the complete partial derivative of <span class="math inline">\(w\)</span> with respect to the relevant independent variable.</p>
<p>To find <span class="math inline">\(\dfrac{\partial w}{\partial s}\)</span>, follow all paths leading from <span class="math inline">\(z\)</span> to <span class="math inline">\(s\)</span>. <span class="math display">\[\begin{array}{rcl}
\textsf{Path via } x \textsf{:} &amp; &amp; \dfrac{\partial w}{\partial x} \dfrac{\partial x}{\partial s} \\[0.5em]
\textsf{Path via } y \textsf{:} &amp; &amp; \dfrac{\partial w}{\partial y} \dfrac{\partial y}{\partial s} \\[0.5em]
\textsf{Path via } z \textsf{:} &amp; &amp; \dfrac{\partial w}{\partial z} \dfrac{\partial z}{\partial s} \\[0.5em]
\textsf{Combine all terms:} &amp; &amp; \dfrac{\partial w}{\partial x} \dfrac{\partial x}{\partial s} + \dfrac{\partial w}{\partial y} \dfrac{\partial y}{\partial s} + \dfrac{\partial w}{\partial z} \dfrac{\partial z}{\partial s} = \dfrac{\partial w}{\partial s}
\end{array}\]</span></p>
<p>You can perform a similar method to find <span class="math inline">\(\dfrac{\partial w}{\partial t}\)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that if a variable has only a single dependency on another variable (no separate branch), a straight <span class="math inline">\(\mathrm{d}\)</span> should be used in the derivative instead of a curly <span class="math inline">\(\partial\)</span>.</p>
</div>
</div>
</section>
<section id="quick-check-problems" class="level1 unnumbered">
<h1 class="unnumbered">Quick check problems</h1>
<div class="webex-check webex-box" data-topic="MCR1">
<ol type="1">
<li>Which of the following correctly describes a dependent variable? <select class="webex-select"><option value="blank"></option><option value="">A variable that is not influenced by other variables</option><option value="answer">A variable that is defined in terms of other variables</option><option value="">A constant value in a function</option></select></li>
</ol>
<!-- -->
<ol start="2" type="1">
<li>Consider the function <span class="math inline">\(z = z(x,y) = x^2 + y^2\)</span> where <span class="math inline">\(x = 2t\)</span> and <span class="math inline">\(y = 3t\)</span>.</li>
</ol>
<!-- -->
<ol type="a">
<li><p>There is/are <input class="webex-solveme nospaces" size="1" data-answer="[&quot;2&quot;]"> dependent variable(s) and <input class="webex-solveme nospaces" size="1" data-answer="[&quot;1&quot;]"> independent variable(s).</p></li>
<li><p>The required form of the multivariate chain rule is <span class="math display">\[\dfrac{\mathrm{d}z}{\mathrm{d}t} = \dfrac{\partial z}{\partial x} \dfrac{\mathrm{d}x}{\mathrm{d}t} + \dfrac{\partial z}{\partial y} \dfrac{\mathrm{d}y}{\mathrm{d}t}\]</span> <select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></p></li>
<li><p>The partial derivative of <span class="math inline">\(z\)</span> with respect to <span class="math inline">\(x\)</span> is <span class="math inline">\(\dfrac{\partial z}{\partial x} =\)</span> <input class="webex-solveme nospaces" size="2" data-answer="[&quot;2x&quot;]">.</p></li>
<li><p>The full derivative of <span class="math inline">\(x\)</span> with respect to <span class="math inline">\(t\)</span> is <span class="math inline">\(\dfrac{\mathrm{d}x}{\mathrm{d}t} =\)</span> <input class="webex-solveme nospaces" size="1" data-answer="[&quot;2&quot;]">.</p></li>
<li><p>The partial derivative of <span class="math inline">\(z\)</span> with respect to <span class="math inline">\(y\)</span> is <span class="math inline">\(\dfrac{\partial z}{\partial y} =\)</span> <input class="webex-solveme nospaces" size="2" data-answer="[&quot;2y&quot;]">.</p></li>
<li><p>The full derivative of <span class="math inline">\(y\)</span> with respect to <span class="math inline">\(t\)</span> is <span class="math inline">\(\dfrac{\mathrm{d}y}{\mathrm{d}t} =\)</span> <input class="webex-solveme nospaces" size="1" data-answer="[&quot;3&quot;]">.</p></li>
<li><p>Use the multivariate chain rule to find the full derivative of <span class="math inline">\(z\)</span> with respect to <span class="math inline">\(t\)</span>, expressing your answer in terms of <span class="math inline">\(t\)</span> only. <span class="math inline">\(\dfrac{\mathrm{d}z}{\mathrm{d}t} =\)</span> <input class="webex-solveme nospaces" size="3" data-answer="[&quot;26t&quot;]"></p></li>
</ol>
</div>
</section>
<section id="further-reading" class="level1">
<h1>Further reading</h1>
<p><a href="../questions/qs-multivariatechainrule.html">For more questions on the subject, please go to Questions: Multivariate chain rule.</a></p>
<p>For a way to differentiate implicit functions of more than one variable, please see Guide: Multivariate implicit differentiation.</p>
<section id="version-history" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="version-history">Version history</h2>
<p>v1.0: initial version created 05/25 by Donald Campbell as part of a University of St Andrews VIP project.</p>
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1">This work is licensed under CC BY-NC-SA 4.0.</a></p>


</section>
</section>

</main> <!-- /main -->
<script>

/* once a quickcheck is completed, we pass in the topic id and concatenate it into a quickcheck (qc) id
   and store that in local storage to persist across webpages so we know which topics have been completed */
function markTopicCompleted(topicId) {
  if (!topicId || typeof topicId !== 'string') { console.error('Invalid topicId:', topicId); return; }
  
  const storageKey = 'qc-completed-' + topicId;
  localStorage.setItem(storageKey, 'true');
  console.log(`Marked ${topicId} as completed (key: ${storageKey})`);
  
  updateTopicStatus(topicId); 
}

/* select all elements related to a certain topic, then check by fetching from local storage 
   whether the corresponding qc-id is marked as true for completed, or false for uncompleted 
   if so, add the "completed" css class id, for webex.css to update from a red cross to a green tick */
function updateTopicStatus(topicId) {
  const elements = document.querySelectorAll(`[data-topic="${topicId}"]`);
  const isCompleted = localStorage.getItem(`qc-completed-${topicId}`) === 'true';
  
  elements.forEach(el => {
    if (isCompleted) el.classList.add("completed");
    else el.classList.remove("completed");
  })

  console.log(`Updated UI for ${topicId}:`, isCompleted);
}

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");
  let allCorrect = false;

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) 
  {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
    if (correct === (solvemes + radiogroups + selects) && correct > 0) allCorrect = true;
  }

  if (allCorrect) // get the data-topic id for guide that just had its quick check problem fully completed and pass into chain of functions
  {
    const quickCheck = document.querySelector(".webex-check");
    const topicId = quickCheck?.getAttribute("data-topic");
    if (topicId) markTopicCompleted(topicId);
  }
}

/* used to identify each data topic element (on fullindex.html and each guide) and update the red cross to a green tick
   based on whether the corresponding quickcheck problem(s) have been completed for each respective guide */
function initializeAllTopics() {
  document.querySelectorAll('[data-topic]').forEach(el => {
    const topicId = el.getAttribute('data-topic');
    updateTopicStatus(topicId);
  });
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) cl.remove("open");
  else cl.add("open");
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) my_answer = my_answer.toLowerCase();
  if (cl.contains("nospaces")) my_answer = my_answer.replace(/ /g, "");

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if (this.dataset.tol > 0)
  {
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) cl.add("webex-correct");
    else cl.remove("webex-correct");
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) cl.add("webex-correct");
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") cl.add("webex-correct");
  else if (this.value != "blank") cl.add("webex-incorrect");

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") cl.add("webex-correct");
  else cl.add("webex-incorrect");

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++)
    if (buttons[i].parentElement.classList.contains('webex-solution')) buttons[i].onclick = b_func;

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);

  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) real_answer = real_answer.toLowerCase();
    if (cl.contains("nospaces")) real_answer = real_answer.replace(/ /g, "");
  
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) radiogroups[i].onchange = radiogroups_func;

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* check each question to see whether it was answered correctly */
  update_total_correct();

  /* check each data-topic element and update from cross to tick if 
    corresponding quick check problem has been fully completed */
  initializeAllTopics();

  /* listens for storage updates, extracts topic id from qc-id, and updates UI through topic id  */
  window.addEventListener('storage', (changeDetails) => {
    if (changeDetails.key?.startsWith('qc-completed-')) 
    {
      const topicId = changeDetails.key.replace('qc-completed-', '');
      updateTopicStatus(topicId);
    }
  });
}

</script>
<!--------------------  Email Forms -----------------------------------
        Compiled into each .html page by Quarto.
        Website hosted and form handled by Netlify now
        Mailing list provided by mailerlite
        Input verified by reCaptcha2 
        
        Authors (recent to latest): 
           Tristin Doherty (Trido)
           Mohit Agarwal (Mohit-Agarwa1)
--------------------------------------------------------------------->
<script>
  // Adds an extra layer of validation to aid user input,
  // some of these are covered by basic html form validations as well, but netlify handles everything else
  document.addEventListener("DOMContentLoaded", function() {
    const form = document.querySelector("form[name='feedback']"); 
    
    form.addEventListener("submit", function(event) {
        const nameInput = document.querySelector("input[name='name']")?.value.trim();
        const emailInput = document.querySelector("input[name='email']")?.value.trim(); 
        const feedbackInput = document.querySelector("textarea[name='feedback']")?.value.trim();

        if (!nameInput)    { alert("Please enter a name."); return; }
        if (!emailInput)   { alert("Please enter an email."); return; }
        if (!feedbackInput) { alert("Please fill out the feedback field."); return; }
        
        event.preventDefault(); //allows javascript to handle submitting form details instead of HTML
        const subjectInput = document.querySelector("input[name='subject']");
                
        // sanitise inputs
        const sanitizedName = sanitizeInput(nameInput); 
        const sanitizedEmail = sanitizeEmail(emailInput);
        const sanitizedFeedback = sanitizeInput(feedbackInput);

        // validate email
        if (!validateEmail(sanitizedEmail)) { alert("Please enter a valid email address."); return; }
        subjectInput.value = "Feedback from " + sanitizedEmail; // Updates subject line with sanitised email

        form.submit();
    });
});

// Removes leading and trailing whitespace for formatting, and replaces potentially harmful characters like "<" & ">", replaces them with HTML encodings
function sanitizeInput(input) {
  input = input.trim();                                      
  input = input.replace(/</g, "&lt;").replace(/>/g, "&gt;");
  return input;
}

// remove harmful characters from email being sent to subject line, by only permitting the characters specified in .replace()
function sanitizeEmail(email) {
  email = email.trim(); 
  email = email.replace(/[^a-zA-Z0-9@._-]/g, "");
  return email;
}

// This looks incredibly complicated, but its just regex taken from here to filter for emails that follow these formatting guidelines https://regex101.com/r/3uvtNl/1
function validateEmail(email) {
  const re = /^((?:[A-Za-z0-9!#$%&'*+\-\/=?^_`{|}~]|(?<=^|\.)"|"(?=$|\.|@)|(?<=".*)[ .](?=.*")|(?<!\.)\.){1,64})(@)((?:[A-Za-z0-9.\-])*(?:[A-Za-z0-9])\.(?:[A-Za-z0-9]){2,})$/gm; 
  return re.test(email);
}

</script>

<h1>Feedback</h1>
<p>Your feedback is appreciated and useful. Feel free to leave a comment here, <br>
but please be specific with any issues you encounter so we can help to resolve them <br>
(for example, what page it occured on, what you tried, and so on). </p>

<form name="feedback" method="POST" netlify="" netlify-honeypot="bot-field">
  <p style="display: none;"><label>Don't fill this out if you're human: <input name="bot-field"></label></p>
  <input type="hidden" name="subject" value="Feedback from unknown">

  <label for="name">Name: </label>
  <br>
  <input type="text" name="name" required="">
  <br><br>
  
  <label for="email">E-mail: </label>
  <br>
  <input type="email" name="email" required="">
  <br><br>
  
  <label for="feedback">Feedback: </label>
  <br>
  <textarea rows="5" cols="50" placeholder="Your feedback" name="feedback" required=""></textarea>
  <br><br>

  <!-- Google reCAPTCHA Widget -->
  <div class="g-recaptcha" data-sitekey="6LeiTt4qAAAAAGaEQOUljIc9e3iqDz6eH9Te_lQr"></div>
  <br>

  <button type="submit">Submit</button>
</form>

<script src="https://www.google.com/recaptcha/api.js" async="" defer=""></script>
<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement(
      { pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.VERTICAL },
      'google_translate_element'
    );
  }
</script>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function () {
    const targetSidebar = document.getElementById('quarto-margin-sidebar');
    if (!targetSidebar) return;

    const translateWrapper = document.createElement('div');
    translateWrapper.className = 'sidebar-section';
    translateWrapper.style.marginTop = '2em';

    const title = document.createElement('h5');
    title.innerText = 'Translate';

    const translatorDiv = document.createElement('div');
    translatorDiv.id = 'google_translate_element';

    translateWrapper.appendChild(title);
    translateWrapper.appendChild(translatorDiv);
    targetSidebar.appendChild(translateWrapper);

    const googleScript = document.createElement('script');
    googleScript.type = 'text/javascript';
    googleScript.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
    document.body.appendChild(googleScript);
  });
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../fullindex.html">
<p>Index</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../cookies.html">
<p>Cookie policy</p>
</a>
  </li>  
</ul>
    <div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../license.html">
<p>STARMAST © 2025 is licensed under CC BY-NC-SA 4.0.</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>