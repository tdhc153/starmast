{
  "hash": "84cf833a70369f586538337f93c50543",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Multivariate chain rule\nauthor: Donald Campbell\nabstract-title: Summary\nabstract: The multivariate chain rule is used in calculus to differentiate a function when its variables depend on other variables. It shows how the change in one variable affects the whole function by considering how the intermediate variables change.\ncategories:\n  - Calculus\ndraft: true\n---\n\n\n\n\n\n\n\n\n\n\n*Before reading this guide, it is recommended that you read [Guide: Introduction to partial differentiation](introtopartialdifferentiation.qmd).*\n\nThe **multivariate chain rule** allows you to compute derivatives of composite functions (functions of functions) involving multiple variables. It allows you to track how changes in **independent variables** influence a final quantity through intermediate variables called **dependent variables**.\n\n# Dependent and independent variables\n\nWhen a function **depends** on a specific variable, this means that the function is written with the variable in its rule. For example, the function $f(x,y) = x^2 + y^2$ depends on $x$ and $y$ as the function is written in terms of $x$ and $y$.\n\nA **multivariate (or multivariable) function** is a function that depends on more than one variable.\n\nConsider a multivariate function $w = f(x,y,z) = 2x^2 + xy + 3xz$ where\n\n$$\n\\begin{aligned}\nx(s,t) &= s^2 - t \\\\\ny(s,t) &= s^2 + t \\\\\nz(s,t) &= 2s + t^2\n\\end{aligned}\n$$\n\nThe variables $x$, $y$ and $z$ are referred to as **dependent variables** as they are functions that depend on (can be written in terms of) the variables $s$ and $t$. Even though $x$, $y$ and $z$ are referred to as dependent variables, they are actually functions of the variables $s$ and $t$. In this case, the dependent variables can be written in functional form as $x = x(s,t)$, $y = y(s,t)$ and $z = z(s,t)$ to emphasize dependency.\n\nThe variables $s$ and $t$ are referred to as **independent variables** as they do not depend on any other variables.\n\nOccasionally, dependent variables may be referred to as **intermediate variables** since they connect the independent variables $s$ and $t$ to the final quantity $w$.\n\n# Functions of one dependent variable with one independent variable (recap)\n\nWhen you have a function $y=f(x)$ where $x$ depends on another variable $t$, the chain rule tells you how to differentiate $y$ with respect to $t$.\n\n::: callout-note\n## Chain rule for functions of a single independent variable\n\nLet $y=f(x)$ where $f$ is a differentiable function of $x$. Also let $x = x(t)$ be a differentiable function of $t$.\n\nThe function $y$ can then be differentiated with respect to $t$ according to\n\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = \\frac{\\mathrm{d}y}{\\mathrm{d}x}\\frac{\\mathrm{d}x}{\\mathrm{d}t}\n$$\n:::\n\n::: callout-important\nIt is important to use $\\mathrm{d}$ here instead of $\\partial$ since $x$ and $y$ are functions of a single independent variable $t$. In contrast, when working with functions of multiple variables, you would use a curly $\\partial$.\n:::\n\nIt is useful to see how this works through an example. The chain rule helps you to differentiate composite functions by breaking them into an outer and inner function. You need to differentiate each part separately and then multiply the results.\n\n::: {.callout-note appearance=\"simple\"}\n## Example 1\n\nLet $y = f(x) = x^5$ where $x = 3t^2 + 2$. Use the chain rule to find $\\dfrac{\\mathrm{d}y}{\\mathrm{d}t}$.\n\nFirst, calculate the derivatives required for the chain rule.\n\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} &= 5x^4 \\\\\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} &= 6t\n\\end{aligned}\n$$\n\nApply the chain rule then substitute for $x=3t^2+2$.\n\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= \\frac{\\mathrm{d}y}{\\mathrm{d}x}\\frac{\\mathrm{d}x}{\\mathrm{d}t} \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= (5x^4)(6t) \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= \\left( 5(3t^2+2)^4 \\right) \\left( 6t \\right) \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} &= 30t(3t^2+2)^4\n\\end{aligned}\n$$\n:::\n\nThe chain rule also extends to functions of two dependent variables.\n\n# Functions of two dependent variables with one independent variable\n\nSuppose you have a function $z = f(x,y)$.\n\nHere, $z$ depends on two dependent variables $x$ and $y$, however both $x$ and $y$ are functions of a single independent variable $t$.\n\n$$\nx=x(t) \\quad \\text{and} \\quad y=y(t)\n$$\n\nThis means that, even though $z$ initially looks like a function of two dependent variables $x$ and $y$, it really depends on a single independent variable $t$, and you could write $z$ entirely in terms of $t$.\n\n$$\nz = f \\left( x(t), y(t) \\right)\n$$\n\nThe goal is to find $\\dfrac{\\mathrm{d}z}{\\mathrm{d}t}$.\n\nYou cannot differentiate $z = f(x,y)$ directly with respect to $t$ because $z$ depends intermediately on both $x$ and $y$. Instead, you need to use the multivariate chain rule.\n\n::: callout-note\n## Multivariate chain rule for one independent variable\n\nLet $z=f(x,y)$ where $f$ is a differentiable function of $x$ and $y$. Also let $x=x(t)$ and $y=y(t)$ be differentiable functions of $t$.\n\nThe function $z$ can then be differentiated with respect to $t$ according to\n\n$$\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} = \\frac{\\partial z}{\\partial x}\\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{\\partial z}{\\partial y}\\frac{\\mathrm{d}y}{\\mathrm{d}t}\n$$\n:::\n\n::: callout-important\nThe left-most derivative $\\dfrac{\\mathrm{d}z}{\\mathrm{d}t}$ is written with a straight $\\mathrm{d}$ as $z=z(t)$ is considered a function of $t$ only at this stage. Here, $z$ is written using the expressions for $x$ and $y$ in terms of $t$.\n\nDerivatives such as $\\dfrac{\\partial{z}}{\\partial{x}}$ and $\\dfrac{\\partial{z}}{\\partial{y}}$ are written with a curly $\\partial$ as $z$ is a function that depends on two variables $x$ and $y$.\n\nDerivatives such as $\\dfrac{\\mathrm{d}x}{\\mathrm{d}t}$ and $\\dfrac{\\mathrm{d}y}{\\mathrm{d}t}$ are written with a straight $\\mathrm{d}$ as $x$ is a function that depends only on a single variable $t$.\n:::\n\nAs $t$ changes, both dependent variables $x$ and $y$ change as they are both functions of the independent variable $t$. This causes $z$ to change as it is a function of variables $x$ and $y$ which are changing.\n\nThe total rate of change of $z$ depends on:\n\n-   The product $\\dfrac{\\partial z}{\\partial x}\\dfrac{\\mathrm{d}x}{\\mathrm{d}t}$ which is how sensitive $z$ is to $x$, scaled by how sensitive $x$ is to $t$.\n\n-   The product $\\dfrac{\\partial z}{\\partial y}\\dfrac{\\mathrm{d}y}{\\mathrm{d}t}$ which is how sensitive $z$ is to $y$, scaled by how sensitive $y$ is to $t$.\n\nThe chain rule combines these two effects to get the required derivative $\\dfrac{\\mathrm{d}z}{\\mathrm{d}t}$.\n\n::: {.callout-note appearance=\"simple\"}\n## Example 2\n\nLet $z = f(x,y) = x^3 + y^3$ where $x=3t^2$ and $y=\\cos{(t)}$. Use the multivariate chain rule to find $\\dfrac{\\mathrm{d}z}{\\mathrm{d}t}$.\n\nFirst, calculate the derivatives required for the multivariate chain rule.\n\n$$\n\\begin{aligned} \\frac{\\partial{z}}{\\partial{x}} &= 3x^2 \\\\ \\frac{\\partial{z}}{\\partial{y}} &= 3y^2 \\\\ \\frac{\\mathrm{d}x}{\\mathrm{d}t} &= 6t \\\\ \\frac{\\mathrm{d}y}{\\mathrm{d}t} &= -\\sin{(t)}\n\\end{aligned}\n$$\n\nApply the multivariate chain rule then substitute for $x=3t^2$ and $y=\\cos{(t)}$.\n\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} &= \\frac{\\partial z}{\\partial x}\\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{\\partial z}{\\partial y}\\frac{\\mathrm{d}y}{\\mathrm{d}t} \\\\\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} &= (3x^2)(6t) + (3y^2)(-\\sin{(t)}) \\\\\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} &= 3(3t^2)^2(6t) + 3(\\cos{(t)})^2(-\\sin{(t)}) \\\\\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} &= 162t^5 - 3\\sin{(t)}\\cos^2{(t)}\n\\end{aligned}\n$$\n:::\n\n::: callout-important\nYou should make sure that your final answer is always expressed in terms of any independent variables. Your final answer should not include any intermediate variables.\n:::\n\n# Functions of two dependent variables with two independent variables {.unnumbered}\n\nSuppose you have a function $z=f(x,y)$.\n\nHere, $z$ depends on two dependent variables $x$ and $y$, however both $x$ and $y$ are functions of two independent variables $s$ and $t$.\n\n$$\nx=x(s,t) \\quad \\text{and} \\quad y=y(s,t)\n$$\n\nThis means that, even though $z$ initially looks like a function of two dependent variables $x$ and $y$, it really depends on two independent variables $s$ and $t$, and you could write $z$ entirely in terms of $s$ and $t$.\n\n$$\nz = f \\left( x(s,t), y(s,t) \\right)\n$$\n\nSince there are now two independent variables, the goal is to find both $\\dfrac{\\partial{z}}{\\partial{s}}$ and $\\dfrac{\\partial{z}}{\\partial{t}}$.\n\nYou cannot differentiate $z = f(x,y)$ directly with respect to $s$ or $t$ because $z$ depends intermediately on both $x$ and $y$. Instead, you need to use the multivariate chain rule.\n\n::: callout-note\n## Multivariate chain rule for two independent variables\n\nLet $z=f(x,y)$ where $f$ is a differentiable function of $x$ and $y$. Also let $x=x(s,t)$ and $y=y(s,t)$ be differentiable functions of $s$ and $t$.\n\nThe function $z$ can then be differentiated with respect to $s$ and $t$ with\n\n$$\n\\begin{aligned}\n\\frac{\\partial{z}}{\\partial{s}} &= \\frac{\\partial{z}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{s}} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{s}} \\\\\n\\frac{\\partial{z}}{\\partial{t}} &= \\frac{\\partial{z}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{t}} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{t}}\n\\end{aligned}\n$$\n:::\n\n::: callout-important\nThe left-most derivatives $\\dfrac{\\partial{z}}{\\partial{s}}$ and $\\dfrac{\\partial{z}}{\\partial{t}}$ are written with a curly $\\partial$ as $z=z(s,t)$ is considered a function of both $s$ and $t$ at this stage. Here, $z$ is written using the expressions for $x$ and $y$ in terms of $s$ and $t$.\n\nNotice that the $\\dfrac{\\partial{x}}{\\partial{s}}$, $\\dfrac{\\partial{x}}{\\partial{t}}$, $\\dfrac{\\partial{y}}{\\partial{s}}$ and $\\dfrac{\\partial{y}}{\\partial{t}}$ derivatives are now written with a curly $\\partial$ instead of a straight $\\mathrm{d}$ as $x$ and $y$ are functions that now depend on two independent variables $s$ and $t$. This requires partial derivatives instead of ordinary derivatives.\n:::\n\nThe multivariate chain rule works in two steps:\n\n-   To find the partial derivative of $z$ with respect to $s$, combine the sensitivity of $z$ to changes in $x$ and $y$ and the sensitivity of both $x$ and $y$ to changes in $s$.\n\n-   To find the partial derivative of $z$ with respect to $t$, combine the sensitivity of $z$ to changes in $x$ and $y$ and the sensitivity of both $x$ and $y$ to changes in $t$.\n\n::: {.callout-note appearance=\"simple\"}\n## Example 3\n\nLet $z = f(x,y) = x^2 + 3xy$ where $x=s+t^2$ and $y=s^2-t$. Use the multivariate chain rule to find $\\dfrac{\\partial{z}}{\\partial{s}}$ and $\\dfrac{\\partial{z}}{\\partial{t}}$.\n\nFirst, calculate the derivatives required for the multivariate chain rule.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{z}}{\\partial{x}} &=  2x + 3y \\\\\n\\frac{\\partial{z}}{\\partial{y}} &=  3x \\\\\n\\frac{\\partial{x}}{\\partial{s}} &=  1 \\\\\n\\frac{\\partial{x}}{\\partial{t}} &=  2t \\\\\n\\frac{\\partial{y}}{\\partial{s}} &=  2s \\\\\n\\frac{\\partial{y}}{\\partial{t}} &=  -1\n\\end{aligned}\n$$\n\nApply the multivariate chain rule equation then substitute for $x=s+t^2$ and $y=s^2-t$.\n\nCalculate the partial derivative of $z$ with respect to $s$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{z}}{\\partial{s}} &= \\frac{\\partial{z}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{s}} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{s}} \\\\\n\\frac{\\partial{z}}{\\partial{s}} &= (2x+3y)(1) + (3x)(2s) \\\\\n\\frac{\\partial{z}}{\\partial{s}} &= \\left( 2(s+t^2)+3(s^2-t) \\right) \\left( 1 \\right) + \\left( 3(s+t^2) \\right) \\left( 2s \\right) \\\\\n\\frac{\\partial{z}}{\\partial{s}} &= 9s^2 + 2t^2 + 6st^2 + 2s - 3t\n\\end{aligned}\n$$\n\nCalculate the partial derivative of $z$ with respect to $t$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{z}}{\\partial{t}} &= \\frac{\\partial{z}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{t}} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{t}} \\\\\n\\frac{\\partial{z}}{\\partial{t}} &= (2x+3y)(2t) + (3x)(-1) \\\\\n\\frac{\\partial{z}}{\\partial{t}} &= \\left( 2(s+t^2)+3(s^2-t) \\right) \\left( 2t \\right) + \\left( 3(s+t^2) \\right) \\left( -1 \\right) \\\\\n\\frac{\\partial{z}}{\\partial{t}} &= 4t^3-9t^2+6s^2t-3s+4st\n\\end{aligned}\n$$\n:::\n\n# Generalized multivariate chain rule\n\nSuppose you have a function $w = f(x_1, x_2, \\ldots , x_n)$.\n\nHere, $w$ depends on $n$ dependent variables called $x_1, x_2, \\ldots, x_n$ however each of these variables is a function of $m$ independent variables $t_1, t_2, \\ldots, t_m$.\n\n$$\n\\begin{aligned}\nx_1 &= x_1(t_1, t_2, \\ldots, t_m) \\\\\nx_2 &= x_2(t_1, t_2, \\ldots, t_m) \\\\\n\\vdots &= \\vdots \\\\\nx_n &= x_n(t_1, t_2, \\ldots, t_m)\n\\end{aligned}\n$$\n\nThe previous cases investigated were:\n\n$$\n\\begin{aligned}\nn = 1 \\qquad m = 1 &\\qquad y = f(x) \\qquad x = x(t) \\\\\nn = 2 \\qquad m = 1 &\\qquad z = f(x, y) \\qquad x = x(t) \\qquad y = y(t) \\\\\nn = 2 \\qquad m = 2 &\\qquad z = f(x, y) \\qquad x = x(s, t)  \\qquad y = y(s, t)\n\\end{aligned}\n$$ This multivariate chain rule can be generalized as follows.\n\n::: callout-note\n## Generalized multivariate chain rule\n\nLet $w = f(x_1, x_2, \\ldots , x_n)$ where $f$ is a differentiable function of $x_1, x_2, \\ldots, x_n$. Also let the following dependent variables be differentiable functions of $t_1, t_2, \\ldots, t_m$.\n\n$$\n\\begin{aligned}\nx_1 &= x_1(t_1, t_2, \\ldots, t_m) \\\\\nx_2 &= x_2(t_1, t_2, \\ldots, t_m) \\\\\n\\vdots &= \\vdots \\\\\nx_n &= x_n(t_1, t_2, \\ldots, t_m)\n\\end{aligned}\n$$\n\nThe function $w$ can then be differentiated with respect to $t_1, t_2, \\ldots, t_m$ with\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{t_1}} &= \\frac{\\partial{w}}{\\partial{x_1}} \\frac{\\partial{x_1}}{\\partial{t_1}} + \\frac{\\partial{w}}{\\partial{x_2}} \\frac{\\partial{x_2}}{\\partial{t_1}} + \\ldots + \\frac{\\partial{w}}{\\partial{x_n}} \\frac{\\partial{x_n}}{\\partial{t_1}} \\\\\n\\frac{\\partial{w}}{\\partial{t_2}} &= \\frac{\\partial{w}}{\\partial{x_1}} \\frac{\\partial{x_1}}{\\partial{t_2}} + \\frac{\\partial{w}}{\\partial{x_2}} \\frac{\\partial{x_2}}{\\partial{t_2}} + \\ldots + \\frac{\\partial{w}}{\\partial{x_n}} \\frac{\\partial{x_n}}{\\partial{t_2}} \\\\\n\\vdots &= \\vdots \\\\\n\\frac{\\partial{w}}{\\partial{t_m}} &= \\frac{\\partial{w}}{\\partial{x_1}} \\frac{\\partial{x_1}}{\\partial{t_m}} + \\frac{\\partial{w}}{\\partial{x_2}} \\frac{\\partial{x_2}}{\\partial{t_m}} + \\ldots + \\frac{\\partial{w}}{\\partial{x_n}} \\frac{\\partial{x_n}}{\\partial{t_m}}\n\\end{aligned}\n$$\n:::\n\n::: callout-important\nA particular case exists where the variables $x_i$ each depend on only one independent variable $x_1 = x_1(t), x_2 = x_2(t), \\ldots, x_n = x_n(t)$. In this case, a straight $\\mathrm{d}$ should be used instead of a curly $\\partial$.\n\n$$ \\frac{\\mathrm{d}{w}}{\\mathrm{d}{t}} = \\frac{\\partial{w}}{\\partial{x_1}} \\frac{\\mathrm{d}{x_1}}{\\mathrm{d}{t}} + \\frac{\\partial{w}}{\\partial{x_2}} \\frac{\\mathrm{d}{x_2}}{\\mathrm{d}{t}} + \\ldots + \\frac{\\partial{w}}{\\partial{x_n}} \\frac{\\mathrm{d}{x_n}}{\\mathrm{d}{t}} $$\n\nSimilarly, if there is only one dependent variable $x$, then a straight $\\mathrm{d}$ should be used instead of a curly $\\partial$ for the derivatives of $w$ with respect to $x$.\n:::\n\n::: {.callout-note appearance=\"simple\"}\n## Example 4\n\nConsider the case with $n=3$ dependent variables and $m=2$ independent variables.\n\nLet $w = f(x,y,z) = x^2 -3xz + 2xy$ where\n\n$$\n\\begin{aligned}\nx(s,t) &= s^2-t \\\\\ny(s,t) &= s\\cos{(t)} \\\\\nz(s,t) &= t^2-s\n\\end{aligned}\n$$\n\nUse the multivariate chain rule to find $\\dfrac{\\partial{w}}{\\partial{s}}$ and $\\dfrac{\\partial{w}}{\\partial{t}}$.\n\nThe following multivariate chain rule equations will be useful in determining these partial derivatives for $w$. These have been derived from the generalized chain rule equation above.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{s}} &= \\frac{\\partial{w}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{s}} + \\frac{\\partial{w}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{s}} + \\frac{\\partial{w}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{s}} \\\\\n\\frac{\\partial{w}}{\\partial{t}} &= \\frac{\\partial{w}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{t}} + \\frac{\\partial{w}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{t}} + \\frac{\\partial{w}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{t}}\n\\end{aligned}\n$$\n\nFirst, calculate the derivatives required for the multivariate chain rule.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{x}} &= 2x-3z+2y  \\\\\n\\frac{\\partial{w}}{\\partial{y}} &= 2x  \\\\\n\\frac{\\partial{w}}{\\partial{z}} &= -3x  \\\\\n\\frac{\\partial{x}}{\\partial{s}} &= 2s  \\\\\n\\frac{\\partial{x}}{\\partial{t}} &= -1  \\\\\n\\frac{\\partial{y}}{\\partial{s}} &= \\cos{(t)}  \\\\\n\\frac{\\partial{y}}{\\partial{t}} &= -s\\sin{(t)}  \\\\\n\\frac{\\partial{z}}{\\partial{s}} &= -1  \\\\\n\\frac{\\partial{z}}{\\partial{t}} &= 2t \n\\end{aligned}\n$$\n\nApply the multivariate chain rule equation then substitute for $x=s^2-t$, $y = s\\cos{(t)}$ and $z=t^2-s$.\n\nCalculate the partial derivative of $w$ with respect to $s$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{s}} &= \\frac{\\partial{w}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{s}} + \\frac{\\partial{w}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{s}} + \\frac{\\partial{w}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{s}} \\\\\n\\frac{\\partial{w}}{\\partial{s}} &= (2x-3z+2y)(2s) + (2x)(\\cos{(t)}) + (-3x)(-1) \\\\\n\\frac{\\partial{w}}{\\partial{s}} &= \\left( 2(s^2-t)-3(t^2-s)+2s\\cos{(t)} \\right) \\left( 2s \\right) + \\left( 2(s^2-t) \\right) \\left( \\cos{(t)} \\right) + \\left( -3(s^2-t) \\right) \\left( -1 \\right) \\\\\n\\frac{\\partial{w}}{\\partial{s}} &= 4s^3 + 9s^2 + 6s^2\\cos{(t)} - 4st - 6st^2 - 2t\\cos{(t)} - 3t\n\\end{aligned}\n$$\n\nCalculate the partial derivative of $w$ with respect to $t$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{t}} &= \\frac{\\partial{w}}{\\partial{x}}\\frac{\\partial{x}}{\\partial{t}} + \\frac{\\partial{w}}{\\partial{y}}\\frac{\\partial{y}}{\\partial{t}} + \\frac{\\partial{w}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{t}} \\\\\n\\frac{\\partial{w}}{\\partial{t}} &= (2x-3z+2y)(-1) + (2x)(-s\\sin{(t)}) + (-3x)(2t) \\\\\n\\frac{\\partial{w}}{\\partial{t}} &= \\left( 2(s^2-t)-3(t^2-s)+2s\\cos{(t)} \\right) \\left( -1 \\right) + \\left( 2(s^2-t) \\right) \\left( -s\\sin{(t)} \\right) + \\left( -3(s^2-t) \\right) \\left( 2t \\right) \\\\\n\\frac{\\partial{w}}{\\partial{t}} &= -2s^2 + 3t^2 + 2t - 3s - 2s\\cos{(t)} - 2s^3\\sin{(t)} + 2st\\sin{(t)} - 6ts^2 + 6t^2\n\\end{aligned}\n$$\n:::\n\n# Tree representation of the multivariate chain rule\n\nThere is a useful way for determining the required form of the multivariate chain rule without needing to remember the generalized version above. The following diagram is a **tree representation** of the dependencies between variables in a multivariate function.\n\n![Tree diagram for the multivariate chain rule.](FiguresPNG/MCR.png){fig-align=\"center\"}\n\nAt the top of the tree is the function $w = f(x,y,z)$, which depends on three intermediate variables $x$, $y$ and $z$. Each of these three intermediate variables depend on independent variables $s$ and $t$. The tree shows all possible paths from $w$ to the independent variables $s$ and $t$.\n\nEach path represents a **chain of differentiation** (a product of derivatives) when applying the chain rule. All paths are combined by summing these chains at the end to find the complete derivative of $w$ with respect to the relevant independent variable.\n\nTo find $\\dfrac{\\partial{w}}{\\partial{s}}$, follow all paths leading from $z$ to $s$.\n\n-   Path via $x$: $\\quad \\dfrac{\\partial{w}}{\\partial{x}} \\dfrac{\\partial{x}}{\\partial{s}}$\n\n-   Path via $y$: $\\quad \\dfrac{\\partial{w}}{\\partial{y}} \\dfrac{\\partial{y}}{\\partial{s}}$\n\n-   Path via $z$: $\\quad \\dfrac{\\partial{w}}{\\partial{z}} \\dfrac{\\partial{z}}{\\partial{s}}$\n\n-   Combine all terms: $\\quad \\dfrac{\\partial{w}}{\\partial{s}} = \\dfrac{\\partial{w}}{\\partial{x}} \\dfrac{\\partial{x}}{\\partial{s}} + \\dfrac{\\partial{w}}{\\partial{y}} \\dfrac{\\partial{y}}{\\partial{s}} + \\dfrac{\\partial{w}}{\\partial{z}} \\dfrac{\\partial{z}}{\\partial{s}}$\n\nTo find $\\dfrac{\\partial{w}}{\\partial{t}}$, follow all paths leading from $z$ to $s$.\n\n-   Path via $x$: $\\quad \\dfrac{\\partial{w}}{\\partial{x}} \\dfrac{\\partial{x}}{\\partial{t}}$\n\n-   Path via $y$: $\\quad \\dfrac{\\partial{w}}{\\partial{y}} \\dfrac{\\partial{y}}{\\partial{t}}$\n\n-   Path via $z$: $\\quad \\dfrac{\\partial{w}}{\\partial{z}} \\dfrac{\\partial{z}}{\\partial{t}}$\n\n-   Combine all terms: $\\quad \\dfrac{\\partial{w}}{\\partial{t}} = \\dfrac{\\partial{w}}{\\partial{x}} \\dfrac{\\partial{x}}{\\partial{t}} + \\dfrac{\\partial{w}}{\\partial{y}} \\dfrac{\\partial{y}}{\\partial{t}} + \\dfrac{\\partial{w}}{\\partial{z}} \\dfrac{\\partial{z}}{\\partial{t}}$\n\n::: callout-important\nRemember that if a variable has only a single dependency on another variable (no separate branch), a straight $\\mathrm{d}$ should be used in the derivative instead of a curly $\\partial$.\n:::\n\nThis visual aid can be useful as an alternative method to remembering the generalized equation.\n\n# Quick check problems {.unnumbered}\n\n:::: {.content-visible when-format=\"html\"}\n::: {.webex-check .webex-box}\nConsider the function $z = f(x,y) = xy^2 + 3x^2$ where $x = t^2-\\cos{(2t)}$ and $y = 2t + 5\\sin{(t)}$.\n\nThere is/are _ dependent variable(s) and _ independent variable(s).\n\nThe required form of the multivariate chain rule is $\\dfrac{\\mathrm{d}z}{\\mathrm{d}t} = \\dfrac{\\partial{z}}{\\partial{x}} \\dfrac{\\mathrm{d}x}{\\mathrm{d}t} + \\dfrac{\\partial{z}}{\\partial{y}} \\dfrac{\\mathrm{d}y}{\\mathrm{d}t}$. TRUE / FALSE\n\nFill in the blanks of the derivatives required for the multivariate chain rule.\n\nThe derivative of $z$ with respect to $x$ is $\\dfrac{\\partial{z}}{\\partial{x}} =$ _____________________________\n\nThe derivative of $x$ with respect to $t$ is $\\dfrac{\\mathrm{d}x}{\\mathrm{d}t} =$ __________________________________\n\nThe derivative of $z$ with respect to $y$ is $\\dfrac{\\partial{z}}{\\partial{y}} =$ _________________________\n\nThe derivative of $y$ with respect to $t$ is $\\dfrac{\\mathrm{d}y}{\\mathrm{d}t} =$ __________________________\n:::\n::::\n\n::: {.content-hidden when-format=\"html\"}\nConsider the function $z = f(x,y) = xy^2 + 3x^2$ where $x = t^2-\\cos{(2t)}$ and $y = 2t + 5\\sin{(t)}$.\n\nHow many dependent variables and independent variables are there?\n\nDetermine whether the following statement is true or false.\n\nThe required form of the multivariate chain rule is $\\dfrac{\\mathrm{d}z}{\\mathrm{d}t} = \\dfrac{\\partial{z}}{\\partial{x}} \\dfrac{\\mathrm{d}x}{\\mathrm{d}t} + \\dfrac{\\partial{z}}{\\partial{y}} \\dfrac{\\mathrm{d}y}{\\mathrm{d}t}$.\n\nFind the derivative of $z$ with respect to $x$.\n\nFind the derivative of $x$ with respect to $t$.\n\nFind the derivative of $z$ with respect to $y$.\n\nFind the derivative of $y$ with respect to $t$.\n:::\n\n# Further reading\n\n[For more questions on the subject, please go to Questions: Multivariate chain rule.](../questions/qs-multivariatechainrule.qmd)\n\n[For a way to differentiate implicit functions of more than one variable, please see Guide: Multivariate implicit differentiation.](multivariateimplicitdifferentiation.qmd)\n\n## Version history {.unnumbered}\n\nv1.0: initial version created 05/25 by Donald Campbell as part of a University of St Andrews VIP project.\n\n[This work is licensed under CC BY-NC-SA 4.0.](https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}