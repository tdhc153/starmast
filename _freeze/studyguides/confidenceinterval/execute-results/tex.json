{
  "hash": "e63cce526c2cb94d6d90605a3838b29d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Introduction to confidence intervals\nauthor: Millie Harris\nabstract-title: Summary\nabstract: In statistics, to estimate an unknown parameter you can construct a confidence interval. This is the range of values you expect the true estimate to fall between if you were to repeat the study several times, with a certain level of confidence. This study guide introduces confidence intervals, confidence levels, and Z values using the normal distribution.\ncategories:\n  - Statistics\ndraft: true\nfilters:\n  - shinylive\n---\n\n\n\n*Before reading this guide, it is recommended that you read* [Guide: Introduction to hypothesis testing](hypothesistesting.qmd), [Guide: Introduction to probability](introtoprobability.qmd), *and* [Guide: Expected value, variance, standard deviation](expectedvariance.qmd)\n\nThis guide will focus on how to construct and interpret a confidence interval using the **normal distribution**. For information on confidence intervals using other distributions see \\[Guide: More on confidence intervals\\].\n\n## The normal distribution\n\n```{shinylive-r}\n#| include: false\n#| standalone: true\n#| viewerHeight: 340\nlibrary(shiny)\nlibrary(bslib)\nlibrary(ggplot2)\n\nui <- page_sidebar(\n  title = \"Normal Distribution Tails Explained\",\n  sidebar = sidebar(\n    numericInput(\"mu\", \n                 \"Mean (μ):\", \n                 value = 0, \n                 step = 0.1),\n    numericInput(\"sigma\", \n                 \"Standard Deviation (σ):\", \n                 value = 1, \n                 min = 0.1, \n                 step = 0.1),\n    hr(),\n    sliderInput(\"tail_threshold\",\n                \"Tails:\",\n                min = 1,\n                max = 3,\n                value = 2,\n                step = 0.1),\n    hr(),\n    p(\"The distribution curve is shown in blue.\"),\n    p(\"Red areas represent the tails beyond the threshold.\"),\n    p(\"Use the threshold slider to see how tail areas change.\")\n  ),\n  card(\n    card_header(\"Normal Distribution with Highlighted Tails\"),\n    plotOutput(\"tail_plot\", height = \"500px\")\n  )\n)\n\nserver <- function(input, output, session) {\n  output$tail_plot <- renderPlot({\n    x_range <- c(input$mu - 4 * input$sigma, input$mu + 4 * input$sigma)\n    x <- seq(x_range[1], x_range[2], length.out = 1000)\n    \n    y <- dnorm(x, mean = input$mu, sd = input$sigma)\n    \n    left_tail <- input$mu - input$tail_threshold * input$sigma\n    right_tail <- input$mu + input$tail_threshold * input$sigma\n    \n    df <- data.frame(x = x, y = y)\n    \n    p <- ggplot(df, aes(x = x, y = y)) +\n      geom_line(color = \"blue\", size = 1.2) +\n      geom_area(data = df[df$x >= left_tail & df$x <= right_tail, ], \n                alpha = 0.2, fill = \"lightblue\") +\n      geom_area(data = df[df$x <= left_tail, ], \n                alpha = 0.6, fill = \"red\") +\n      geom_area(data = df[df$x >= right_tail, ], \n                alpha = 0.6, fill = \"red\") +\n      geom_vline(xintercept = left_tail, color = \"red\", size = 1, linetype = \"dashed\") +\n      geom_vline(xintercept = right_tail, color = \"red\", size = 1, linetype = \"dashed\") +\n      geom_vline(xintercept = input$mu, color = \"blue\", size = 1, linetype = \"dotted\") +\n      labs(\n        title = \"The normal distribution\",\n        subtitle = paste(\"μ =\", input$mu, \", σ =\", input$sigma)\n      ) +\n      theme_minimal() +\n      theme(\n        plot.title = element_text(size = 16, hjust = 0.5),\n        plot.subtitle = element_text(size = 12, hjust = 0.5),\n        axis.title = element_text(size = 12),\n        axis.text = element_text(size = 10)\n      )\n    \n    max_y <- max(y)\n    p + annotate(\"text\", \n                 x = input$mu, \n                 y = max_y * 0.9, \n                 label = \"μ\", \n                 color = \"blue\", \n                 size = 5) +\n        annotate(\"text\", \n                 x = left_tail, \n                 y = max_y * 0.5, \n                 label = paste(\"-\", input$tail_threshold, \"σ\"), \n                 color = \"red\", \n                 size = 4, \n                 hjust = 1.1) +\n        annotate(\"text\", \n                 x = right_tail, \n                 y = max_y * 0.5, \n                 label = paste(\"+\", input$tail_threshold, \"σ\"), \n                 color = \"red\", \n                 size = 4, \n                 hjust = -0.1)\n  })\n}\n\nshinyApp(ui = ui, server = server)\n\n```\n\nThe normal distribution, or sometimes called the \"bell-curve\", is a symmetrical graph which represents data that clusters around the mean. It depends on two parameters: the mean $(\\mu)$ and the standard deviation $(\\sigma)$. In situations where $\\mu = 0$ and $\\sigma = 1$, you have a **standard** normal distribution.\n\nIt is commonly used in statistics for data sets such as average height, average IQ, or average age of people. You would expect these samples to have a lot of values near the mean and less values on each extreme.\n\n::: callout-note\n## Definition of the normal distribution\n\nA random variable $X$ which is normally distributed appears as\n\n$$\nX \\sim N(\\mu, \\sigma)\n$$\n\nwhich you read as $X$ is normally distributed with parameters mu and sigma. Where:\n\n-   mu $=\\mu =$ the mean.\n\n-   sigma $= \\sigma =$ the standard deviation, which tells you how spread out your data is from your mean.\n:::\n\nThe extremes of the distribution are the values furthest away from the mean and are called the **tails**. The total of both tails is alpha $(\\alpha)$ so one tail $= \\frac{\\alpha}{2}$. Under the normal distribution, the alpha value generates a Z value.\n\n## What is a Z value (Z score)?\n\nUsing the normal distribution, a Z value (sometimes called Z score or standard score) is a known test statistic. It shows how many standard deviations above or below the mean an observed data point is.\n\n::: callout-note\n## Definition of the Z value using the normal distribution\n\nA Z value is written $Z_{\\frac{\\alpha}{2}}$, where\n\n-   $\\alpha =$ alpha = the sum of the two tails\n\nSo for:\n\n$$\nZ_\\frac{\\alpha}{2} = Z_{0.025} \n$$\n\n$$\n\\alpha = 0.05\n$$\n:::\n\n::: callout-note\n## Example 1\n\nUse the Z value calculator below to find the Z values for different values of alpha.Try: - $\\alpha = 0.5$ - $\\alpha = 0.1$ - $\\alpha = 0.01$\n\n```{shinylive-r}\n#| standalone: true\n#| viewerHeight: 340\n#| include: false\nlibrary(shiny)\nlibrary(bslib)\n\nui <- page_fluid(\n  title = \"Z-table calculator\",\n  fluidRow(\n    column(\n      width = 6,\n      card(\n        card_header(\"Input parameters\"),\n        card_body(\n          style = \"padding: 15px; min-height: 200px;\",\n          # Input for significance level\n          numericInput(\n            \"alpha\",\n            \"Significance Level (α):\",\n            value = 0.05,\n            min = 0.001,\n            max = 0.999,\n            step = 0.001\n          ),\n          \n          # Radio buttons for test type with custom styling\n          tags$div(\n            style = \"margin-top: 15px;\",\n            tags$label(\"Test type:\", style = \"font-weight: bold; margin-bottom: 10px; display: block;\"),\n            radioButtons(\n              \"test_type\",\n              \"\",\n              choices = list(\n                \"One-tailed\" = \"one\",\n                \"Two-tailed\" = \"two\"\n              ),\n              selected = \"two\"\n            )\n          )\n        )\n      )\n    ),\n    \n    column(\n      width = 6,\n      card(\n        card_header(\"Z-score results\"),\n        card_body(\n          style = \"padding: 15px; min-height: 200px;\",\n          div(\n            style = \"text-align: center;\",\n            h4(\"Critical Z-score:\", style = \"color: #3F68B6; margin-bottom: 5px;\"),\n            div(\n              style = \"font-size: 32px; font-weight: bold; color: #3F68B6; margin: 5px 0;\",\n              textOutput(\"z_score\", inline = TRUE)\n            ),\n            div(\n              style = \"margin-top: 8px; font-size: 14px;\",\n              textOutput(\"interpretation\")\n            )\n          )\n        )\n      )\n    )\n  ),\n  \n  # Custom CSS for styling the radio buttons\n  tags$style(HTML(\"\n    .radio label {\n      color: black !important;\n      font-weight: 500;\n    }\n    .radio input[type='radio'] {\n      accent-color: black;\n    }\n  \"))\n)\n\nserver <- function(input, output, session) {\n  \n  # Calculate Z-score based on significance level and test type\n  z_value <- reactive({\n    alpha <- input$alpha\n    \n    if (input$test_type == \"one\") {\n      # One-tailed test: find Z such that P(Z > z) = alpha\n      z_score <- qnorm(1 - alpha)\n    } else {\n      # Two-tailed test: find Z such that P(|Z| > z) = alpha\n      # This means P(Z > z) = alpha/2\n      z_score <- qnorm(1 - alpha/2)\n    }\n    \n    return(round(z_score, 4))\n  })\n  \n  # Output the Z-score\n  output$z_score <- renderText({\n    z_value()\n  })\n  \n  # Provide interpretation\n  output$interpretation <- renderText({\n    test_type <- ifelse(input$test_type == \"one\", \"one-tailed\", \"two-tailed\")\n    paste0(\"For a \", test_type, \" test with α = \", input$alpha)\n  })\n}\n\nshinyApp(ui = ui, server = server)\n```\n:::\n\nUsing this, you can define your confidence level which you will need when constructing a confidence interval.\n\n## What is a confidence level?\n\n::: callout-note\n## Definition of a confidence level\n\nA **confidence level** (CL) suggests that if you were to repeat the study many times, you would expect the true estimate to fall within CL$\\%$ of the results.\n\nA CL is typically represented using a percentage or decimal. For example, a $95\\%$ CL can be represented as $0.95$.\n:::\n\nUsing the normal distribution the confidence level, alpha value, and Z value are used to construct a confidence interval.\n\n## So, what is a confidence interval?\n\nIf you were conducting a study and took several different samples of data, the mean for that data could be slightly different each time. So, when estimating population means, instead of providing one value, you can specify a **range of values** which is likely to contain the true mean. This is called a confidence interval (CI).\n\nCIs are a vital tool used in economics, medicine, and they can measure uncertainties in everyday life. For example, weather forecasting or outcomes in sports.\n\n::: callout-note\n## Definition of confidence interval using the normal distribution\n\nA **confidence interval** (CI) is written as\n\n$$\n\\bar{x}\\pm SE\n$$\n\nWhich you read as \\$x% bar plus or minus the **standard error**. Where:\n\n-   $\\bar{x} =$ the sample mean\n\n-   $SE =$ the standard error\n\n$$\nSE = Z_\\frac{\\alpha}{2}\\frac{\\sigma}{n} \n$$\n\nWhere:\n\n-   $Z_\\frac{\\alpha}{2} =$ Z value\n\n-   $\\sigma =$ the sample standard deviation\n\n-   $n =$ the sample size\n:::\n\n::: callout-tip\n## Check your work!\n\nThe average of your confidence interval should equal your sample mean.\n\nFor example,\n\n$$\n\\bar{x} = 50, [49.2, 50.8]\n$$\n\nSum the upper and lower bound of the confidence interval, so\n\n$$\n49.2 + 50.8 = 100\n$$\n\nand when you divide by $2$\n\n$$\n\\frac{100}{2} = 50 = \\bar{x}\n$$\n:::\n\n::: callout-note\n## Example 2\n\nCantor's Confectionery use a normal distribution to model the mean weight of their best selling bag of assorted sweets.\n\nUse the slider to adjust the values of $\\alpha$ and see the tails change.\n\n```{shinylive-r}\n#| standalone: true\n#| viewerHeight: 340\n#| include: false\nlibrary(shiny)\nlibrary(bslib)\nlibrary(ggplot2)\n\nui <- page_sidebar(\n  title = \"Cantor's Confectionery: The normal distribution for assorted sweets\",\n  sidebar = sidebar(\n    radioButtons(\"alpha_level\",\n                 \"Significance level (α):\",\n                 choices = list(\"α = 0.10\" = 0.10,\n                               \"α = 0.05\" = 0.05,\n                               \"α = 0.01\" = 0.01),\n                 selected = 0.05)\n  ),\n  card(\n    card_header(\"Weight Distribution of Assorted Sweets\"),\n    plotOutput(\"tail_plot\", height = \"500px\")\n  )\n)\n\nserver <- function(input, output, session) {\n  output$tail_plot <- renderPlot({\n    mu <- 100\n    sigma <- 12\n    alpha <- as.numeric(input$alpha_level)\n    \n    x_range <- c(mu - 4 * sigma, mu + 4 * sigma)\n    x <- seq(x_range[1], x_range[2], length.out = 1000)\n    \n    y <- dnorm(x, mean = mu, sd = sigma)\n    \n    z_critical <- qnorm(1 - alpha/2)\n    left_tail <- mu - z_critical * sigma\n    right_tail <- mu + z_critical * sigma\n    \n    df <- data.frame(x = x, y = y)\n    \n    p <- ggplot(df, aes(x = x, y = y)) +\n      geom_line(color = \"blue\", size = 1.2) +\n      geom_area(data = df[df$x >= left_tail & df$x <= right_tail, ], \n                alpha = 0.2, fill = \"lightblue\") +\n      geom_area(data = df[df$x <= left_tail, ], \n                alpha = 0.6, fill = \"red\") +\n      geom_area(data = df[df$x >= right_tail, ], \n                alpha = 0.6, fill = \"red\") +\n      geom_vline(xintercept = left_tail, color = \"red\", size = 1, linetype = \"dashed\") +\n      geom_vline(xintercept = right_tail, color = \"red\", size = 1, linetype = \"dashed\") +\n      geom_vline(xintercept = mu, color = \"blue\", size = 1, linetype = \"dotted\") +\n      labs(\n        title = \"Cantor's Confectionery: The normal distribution for assorted sweets\",\n        subtitle = paste(\"μ =\", mu, \"g, σ =\", sigma, \"g, α =\", alpha)\n      ) +\n      theme_minimal() +\n      theme(\n        plot.title = element_text(size = 16, hjust = 0.5),\n        plot.subtitle = element_text(size = 12, hjust = 0.5),\n        axis.title = element_blank(),\n        axis.text = element_text(size = 10)\n      )\n    \n    p\n  })\n}\n\nshinyApp(ui = ui, server = server)\n```\n\nFrom the distribution,\n\n$$\n\\mu = 100g\n$$\n\nmeans that from the sample, the average weight of the assorted bags of sweets is $100g$.\n\n$$\n\\sigma = 12g\n$$\n\nmeans that from the sample, the standard deviation of the assorted bags of sweets is $12g$.\n:::\n\n::: callout-note\n## Example 3\n\nCantor's Confectionery want to use the normal distribution to construct a $95\\%$ confidence interval for the mean weight of their bags of sweets. They take a sample of $100$ bags which have an average weight of $75g$, the calculated standard deviation is $10g$.\n\nStep 1: What do you need?\n\n-   the sample size is $100$ bags of sweets so $n = 100$\n\n-   the average weight of the sample is $75g$ so $\\bar{x} = 75$\n\n-   the standard deviation of the sample is $10g$ so $\\sigma = 10$\n\n-   the confidence level is $95\\%$ so $\\alpha = 0.05$ and $\\frac{\\alpha}{2} = 0.025$\n\nStep 2: Use the Z value calculator to identify\n\n$$\nZ_\\frac{0.05}{2} = Z_{0.025} = 1.960 \n$$\n\nStep 3: Construct the confidence interval\n\n$$\n\\bar{x} \\pm Z_\\frac{\\alpha}{2}\\frac{\\sigma}{n}\n$$\n\n$$\n= 75 \\pm 1.960(\\frac{10}{100})\n$$\n\n$$\n= [74.804, 75.196]\n$$\n\nStep 4: Check your work\n\n$$\n74.804 + 75.196 = 150\n$$\n\n$$\n\\frac{150}{2} = 75 \n$$\n\nwhere $75 =$ the sample mean, so your confidence interval is correct.\n:::\n\n::: callout-note\n## Example 4\n\nThere is a new shop in town! Lovelace's Lollies are claiming their products are better than Cantor's Confectionery. They take a sample of $77$ of their best selling boxes of lollies. The average weight of these boxes is $84g$ with a standard deviation of $9.5g$. They construct a $95\\%$ confidence interval.\n\n-   $\\bar{x} = 84$\n\n-   $Z_\\frac{0.05}{2} = Z_{0.025} = 1.960$\n\n-   $\\sigma = 9.5$\n\n-   $n = 77$\n\nSo to construct the confidence interval $$\n\\bar{x} \\pm Z_\\frac{\\alpha}{2}\\frac{\\sigma}{n}\n$$\n\n$$\n= 84 \\pm 1.960(\\frac{9.5}{77})\n$$\n\n$$\n= [83.758, 84.242]\n$$\n:::\n\n## Example 3 and 4 in context\n\nCantor's Confectionery and Lovelace's Lollies have both constructed a $95\\%$ confidence interval from a sample of their best selling products. What does this tell you?\n\n-   If Cantor's Confectionery were to repeat the study several times, they would expect the average weight of a bag of sweets to lie between\n\n    $$\n    [74.804, 75.196] g\n    $$\n\n    with $95\\%$ confidence.\n\n-   If Lovelace's Lollies were to repeat the study several times, they would expect the average weight of a box of lollies to lie between\n\n$$\n[83.758, 84.242]g\n$$\n\n::: callout-note\n## Example 5\n\nThe rivalry between Cantor's Confectionery and Lovelace's Lollies has reached the News with the following headline\n\n\"Here to compete with Cantor's Confectionery: Lovelace's Lollies **guarantee** that $95\\%$ of all boxes of lollies will weigh $84.242g$\".\n\nThere are issues with this statement.\n\nFrom the definition of a confidence level, you know that a confidence level suggests that if you were to repeat the study many times, you would expect the true estimate to fall within CL$\\%$ of the results.\n\nThis is not the same as saying CL$\\%$ of the products weigh a certain amount.\n\nInstead, the News headline should read\n\n\"Here to compete with Cantor's Confectionery: A study on a sample of Lovelace's Lollies suggest that if more boxes were to be sampled, they expect $95\\%$ of boxes would weigh between $[83.758, 84.242]g$\".\n:::\n\n::: callout-note\n## Example 6\n\nCantor's Confectionery release a new \"family sized\" bag of sweets to compete with Lovelace's Lollies. They test $150$ bags, in grams $(g)$, from the new batch and generate the following $99\\%$ confidence interval\n\n$$ [126.789, 132.443]  \n$$ with a sample mean of $129.616g$. What is the sample standard deviation?\n\nThe sample mean is given as\n\n$$\n\\bar{x} = 129.616\n$$\n\nThe confidence level is $99\\%$ so under the normal distribution\n\n$$\nZ_\\frac{\\alpha}{2} = Z_{0.005} = 2.576\n$$\n\nThe sample size is\n\n$$\nn = 150\n$$\n\nSo,\n\n$$\n[83.758, 84.242]g\n$$\n\nTo work out the sample standard deviation $(\\sigma)$, you must work back from the confidence interval\n\n$$\n[126.789, 132.443] = \\bar{x} \\pm Z_\\frac{\\alpha}{2} \\frac{\\sigma}{n}\n$$\n\n$$\n[126.789, 132.443] = 129.616 \\pm 2.576(\\frac{\\sigma}{150})\n$$\n\nYou can then use either bound. So, using the lower bound\n\n$$\n126.789 = 129.616 - 2.576(\\frac{\\sigma}{150})\n$$\n\n$$-2.827 = \\frac{-2.576(\\sigma)}{150}\n$$\n\n$$\n\\frac{2.827(150)}{2.576} = \\sigma\n$$\n\nSo,\n\n$$\n\\sigma = 164.616g\n$$\n:::\n\n# Further reading\n\n[For more questions on the subject, please go to Questions: Confidence Intervals.](../questions/qs-confidenceintervals.qmd)\n\n# Version history\n\nv1.0: initial version created 12/06 by Millie Harris as part of a University of St Andrews VIP project.\n\n[This work is licensed under CC BY-NC-SA 4.0.](https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}