{
  "hash": "fd38d1ea0cf39a4d411496d37a5e3ad1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Multivariate implicit differentiation\nauthor: Donald Campbell\nabstract-title: Summary\nabstract: Multivariate implicit differentiation is used to compute partial derivatives for implicitly defined functions using the multivariate chain rule. It allows you to examine how changes in one variable affect others without explicitly solving for the other variables.\ncategories:\n  - Calculus\ndraft: true\n---\n\n\n\n\n\n\n\n\n\n\n*Before reading this guide, it is recommended that you read [Guide: Multivariate chain rule](multivariatechainrule.qmd).*\n\n**Implicit differentiation** is a technique used in calculus when you have a relationship between two variables $x$ and $y$ and you can't solve for one in terms of the other. Instead of isolating $y$ explicitly (writing the equation as $y = \\text{terms in }x$), you differentiate the entire expression using the **chain rule** and **partial derivatives**.\n\nTo understand the idea of implicit differentiation with the chain rule, it is important to first define what the differences are between explicit and implicit functions.\n\n# Explicit and implicit functions\n\nAn **explicit function** expresses one variable directly in terms of the other variables. The method to compute the dependent variable from the independent variables is consistent and often requires rearranging the equation for the dependent variable of interest.\n\n::: callout-note\n## Explicit function\n\nAn explicit function takes the form $y=f(x)$.\n\nIt is a function that can be rearranged into a form where $y$ is distinctly written as a function of only $x$.\n:::\n\n::: callout-tip\nA handy way to think of this functional form is as $y = \\text{terms involving only } x$.\n:::\n\n::: {.callout-note appearance=\"simple\"}\n## Example 1\n\nAn example of an explicit function is the function $y = 2x+3$. The function has been written in the form $y=f(x)$ and you can directly compute $y$ for any value of $x$.\n\nAnother example of an explicit function is the function $x^2 = \\dfrac{3y+2}{y-1}$ which can be rearranged into its explicit form $y = \\dfrac{x^2+2}{x^2-3}$.\n:::\n\nAn **implicit function** defines the relationship between variables while preventing you from solving for one variable in terms of the others. For example, you can't directly express $y$ as a function of $x$ with implicit functions like you can with explicit functions.\n\n::: callout-note\n## Implicit function\n\nAn implicit function takes the form $f(x,y) = 0$.\n\nIt is a function that cannot be rearranged into a form where $y$ is distinctly written as a function of only $x$.\n:::\n\n::: callout-tip\nA handy way to think of this functional form is as $\\text{terms involving both } x \\text{ and } y = 0$ where you cannot rearrange the equation for a function in the form $y = \\text{terms involving only } x$.\n:::\n\n::: {.callout-note appearance=\"simple\"}\n## Example 2\n\nAn example of an implicit function is the equation $x^3 + y^3 - 3xy - 7 = 0$. The equation has been written in the functional form $f(x,y) = 0$. You cannot rearrange the equation to solve for $y$ on its own as with explicit functions.\n\nAnother example of an implicit function is $x^2 + y^2 - 25 = 0$ which is the equation of a circle of radius $5$. This has a solution $y = \\pm \\sqrt{25-x^2}$, however this has not been written as a **single** explicit function as this gives two possible values of $y$ for each $x$. Therefore, it is an implicit function.\n:::\n\n# Paths and contours in the $(x,y)$-plane\n\nImagine you are walking on a surface defined by a function $z=g(x,y)$ that specifies the $z$-coordinate height above the $(x,y)$-plane. The horizontal coordinates are $x$ and $y$, and the height at each point is $z$.\n\nA **path** is a curve you take as you move over the surface. As you move along a path, the $z$-coordinate height changes. The total total rate of change of the height as you move is given by\n\n$$\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} = \\frac{\\partial{z}}{\\partial{x}}\\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}t}\n$$\n\nThis is the **multivariate chain rule** for two dependent variables $x$ and $y$ with one independent variable $t$.\n\nA **contour** is a path where the height (or **function value**) $z$ on this surface you are walking along stays the same. On a map, contour lines show regions of constant elevation. Walking along a contour line means you remain at the same height, whereas walking across contour lines means you are either going up or going down.\n\n![Contours on a 3D plot (change later with own plot)](FiguresPNG/3DContourPlot.png){fig-align=\"center\" width=\"323\"}\n\nSuppose you have a surface $z = g(x,y)$. Each pair of points $(x,y)$ has its own height $z$ called the **function value**. A contour is the set of all points for which $z$ is constant. This is often written as $g(x,y) = \\text{constant}$.\n\n::: {.callout-note appearance=\"simple\"}\n## Example 3\n\nFor example, suppose you have the function $z = g(x,y) = x^2 + y^2 - 25$. This function represents all the points $(x,y)$ on a paraboloid (a three-dimensional shape).\n\nIf you specify $z = g(x,y) = x^2 + y^2 - 25 = 11$, you are defining a contour at height $z=11$. This contour traces out a flat circle of radius $5$. The height is the same for all points $(x,y)$ on this circle.\n\n![Upside-down paraboloid with its contour plot (represent later with own plot and a line on the 3D plot tracing a contour)](FiguresPNG/Paraboloid.png)\n:::\n\n# Implicit differentiation for one variable\n\nOften it is more convenient to redefine $z = g(x,y) = \\text{constant}$ to be $z = f(x,y) = 0$ (a contour of zero height) by including the constant as part of the function.\n\n$$\n\\begin{aligned}\n&g(x,y) = \\text{constant} \\\\\n&g(x,y) - \\text{constant} = 0 \\\\\n&f(x,y) = 0\n\\end{aligned}\n$$\n\nWith the example of the paraboloid, this would involve redefining the circular contour of radius $5$ and height $11$ from $z = g(x,y) = x^2 + y^2 - 25 = 11$ to a circular contour of radius $6$ and height $0$ as $z = f(x,y) = x^2 + y^2 - 36 = 0$.\n\nSince the height $z$ is constant (at zero) along the contour, the height neither increases nor decreases as you walk along the contour so the rate of change of height $z$ is zero. This means the derivatives of $z$ with respect to the independent variable $t$ is defined as\n\n$$\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} = 0\n$$\n\nThis result can be substituted into the multivariate chain rule:\n\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}z}{\\mathrm{d}t} &= \\frac{\\partial{z}}{\\partial{x}}\\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}t} \\\\\n0 &= \\frac{\\partial{z}}{\\partial{x}}\\frac{\\mathrm{d}x}{\\mathrm{d}t} + \\frac{\\partial{z}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}t}\n\\end{aligned}\n$$\n\nSince $f(x,y) = 0$, the total derivative of the function with respect to $x$ must also be zero:\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} f(x,y) =  \\dfrac{\\mathrm{d}f}{\\mathrm{d}x} = 0\n$$\n\nThe function $f(x,y)$ depends on both of the dependent variables $x$ and $y$, so when you differentiate with respect to $x$ you must use the multivariate chain rule.\n\n$$\n\\begin{aligned}\n\\dfrac{\\mathrm{d}f}{\\mathrm{d}x} &= \\frac{\\partial{f}}{\\partial{x}}\\frac{\\mathrm{d}x}{\\mathrm{d}x} + \\frac{\\partial{f}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}x} \\\\\n0 &= \\frac{\\partial{f}}{\\partial{x}} + \\frac{\\partial{f}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}x}\n\\end{aligned}\n$$\n\nThe final step is to rearrange for $\\dfrac{\\mathrm{d}y}{\\mathrm{d}x}$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{f}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}x} &= -\\frac{\\partial{f}}{\\partial{x}} \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} &= - \\frac{\\partial{f} / \\partial{x}}{\\partial{f} / \\partial{y}}\n\\end{aligned}\n$$\n\nThis final result is the equation for implicit differentiation (for one dependent variable) with the chain rule.\n\n::: callout-note\n## Implicit differentiation with the chain rule\n\nIf $f(x,y) = 0$ defines $y=y(x)$ implicitly then\n\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} = - \\frac{\\partial{f} / \\partial{x}}{\\partial{f} / \\partial{y}} = - \\frac{f_x(x,y)}{f_y(x,y)}\n$$\n:::\n\n::: callout-warning\nSince $\\dfrac{\\partial{f}}{\\partial{y}}$ appears on the denominator, this requires $\\dfrac{\\partial{f}}{\\partial{y}} \\neq 0$.\n:::\n\nTo apply this equation, the function must be written in the form $f(x,y) = \\text{terms in } x \\text{ and } y = 0$.\n\nThe following example shows how to use implicit differentiation to find $\\dfrac{\\mathrm{d}y}{\\mathrm{d}x}$ when $y=y(x)$ is defined implicitly by $f(x,y) = x^3y + 2y^2 - 5x^2 - 4y + 7 = 0$.\n\n::: {.callout-note appearance=\"simple\"}\n## Example 4\n\nLet $z = f(x,y) = x^3y + 2y^2 - 5x^2 - 4y + 7 = 0$ and define $y=y(x)$ implicitly.\n\nDetermine $\\dfrac{\\mathrm{d}y}{\\mathrm{d}x}$.\n\nFirst, calculate the derivatives required for the implicit differentiation equation.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{f}}{\\partial{x}} &= 3x^2y - 10x \\\\\n\\frac{\\partial{f}}{\\partial{y}} &= x^3 + 4y - 4\n\\end{aligned}\n$$\n\nApply the implicit differentiation equation and substitute for the derivatives.\n\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} &= - \\frac{\\partial{f} / \\partial{x}}{\\partial{f} / \\partial{y}} \\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} &= - \\frac{3x^2y-10x}{x^3+4y-4}\n\\end{aligned}\n$$\n:::\n\nThe important point is that implicit differentiation allows you to find $\\dfrac{\\mathrm{d}y}{\\mathrm{d}x}$ without solving explicitly for $y$, which is often difficult or impossible to do.\n\nIt would be a lot harder to solve $x^3y + 2y^2 - 5x^2 - 4y + 7 = 0$ for $y$ and then differentiate with respect to $x$.\n\n# Implicit differentiation for two or more variables\n\nSuppose you have a function $z = z(x,y)$ of variables $x$ and $y$ that is defined by\n\n$$\n4x^2 + 3y^2z^2 - 5x^2y + 2z^3 - 7 = 0\n$$\n\nIt is often impractical to express $z$ as an explicit function of $x$ and $y$. Instead, the function is defined implicitly by an equation of the form\n\n$$\nw = f(x,y,z) = 0\n$$\n\nThis defines a surface in four-dimensional space. Since this surface implicitly defines $z$ in terms of $x$ and $y$, you can use the chain rule to differentiate implicitly and find the partial derivatives $\\dfrac{\\partial{z}}{\\partial{x}}$ and $\\dfrac{\\partial{z}}{\\partial{y}}$ without explicitly solving for $z$.\n\nSince the function value $w$ is constant (at zero) along the contour, the function value neither increases nor decreases as you traverse the contour so the rate of change of the function value $w$ is zero. This means the partial derivatives of $w$ with respect to the independent variables $x$ and $y$ are defined as\n\n$$\n\\frac{\\partial{w}}{\\partial{x}} = 0 \\qquad \\text{and} \\qquad \\frac{\\partial{w}}{\\partial{y}} = 0\n$$You can now use the chain rule to differentiate implicitly with $z=z(x,y)$.\n\nApply the multivariate chain rule to differentiate $w$ with respect to $x$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{x}} &= \\frac{\\partial{f}}{\\partial{x}}\\frac{\\mathrm{d}x}{\\mathrm{d}x} + \\frac{\\partial{f}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{x}} \\\\\n0 &= \\frac{\\partial{f}}{\\partial{x}} + \\frac{\\partial{f}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{x}}\n\\end{aligned}\n$$\n\nThe next step is to rearrange for $\\dfrac{\\partial{z}}{\\partial{x}}$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{f}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{x}} &= -\\frac{\\partial{f}}{\\partial{x}} \\\\\n\\frac{\\partial{z}}{\\partial{x}} &= - \\frac{\\partial{f} / \\partial{x}}{\\partial{f} / \\partial{z}}\n\\end{aligned}\n$$\n\nApply the multivariate chain rule to differentiate $w$ with respect to $y$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{w}}{\\partial{y}} &= \\frac{\\partial{f}}{\\partial{y}}\\frac{\\mathrm{d}y}{\\mathrm{d}y} + \\frac{\\partial{f}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{y}} \\\\\n0 &= \\frac{\\partial{f}}{\\partial{y}} + \\frac{\\partial{f}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{y}}\n\\end{aligned}\n$$\n\nThe next step is to rearrange for $\\dfrac{\\partial{z}}{\\partial{y}}$.\n\n$$\n\\begin{aligned}\n\\frac{\\partial{f}}{\\partial{z}}\\frac{\\partial{z}}{\\partial{y}} &= -\\frac{\\partial{f}}{\\partial{y}} \\\\\n\\frac{\\partial{z}}{\\partial{y}} &= - \\frac{\\partial{f} / \\partial{y}}{\\partial{f} / \\partial{z}}\n\\end{aligned}\n$$\n\n::: callout-note\n## Implicit differentiation with the chain rule\n\nIf $f(x,y,z) = 0$ defines $z = z(x,y)$ implicitly then\n\n$$\n\\begin{aligned}\n\\frac{\\partial{z}}{\\partial{x}} &= - \\frac{\\partial{f} / \\partial{x}}{\\partial{f} / \\partial{z}} = - \\frac{f_x(x,y)}{f_z(x,y)} \\\\\n\\frac{\\partial{z}}{\\partial{y}} &= - \\frac{\\partial{f} / \\partial{y}}{\\partial{f} / \\partial{z}} = - \\frac{f_y(x,y)}{f_z(x,y)}\n\\end{aligned}\n$$\n:::\n\n::: callout-warning\nSince $\\dfrac{\\partial{f}}{\\partial{z}}$ appears on the denominator of both equations, this requires $\\dfrac{\\partial{f}}{\\partial{z}} \\neq 0$.\n:::\n\nTo apply this equation, the function must be written in the form $f(x,y,z) = \\text{terms in } x \\text{, y } \\text{and } z = 0$\n\nThe following example shows how to use implicit differentiation to find $\\dfrac{\\partial{z}}{\\partial{x}}$ and $\\dfrac{\\partial{z}}{\\partial{y}}$ when $z=z(x,y)$ is defined implicitly by $f(x,y,z) = 4x^2 + 3y^2z^2 - 5x^2y + 2z^3 - 7 = 0$.\n\n::: {.callout-note appearance=\"simple\"}\n## Example 5\n\nLet $w = f(x,y,z) = 4x^2 + 3y^2z^2 - 5x^2y + 2z^3 - 7 = 0$ and define $z=z(x,y)$ implicitly.\n\nDetermine $\\dfrac{\\partial{z}}{\\partial{x}}$ and $\\dfrac{\\partial{z}}{\\partial{y}}$.\n\nFirst, calculate the derivatives required for the implicit differentiation equations.\n\n$$\n\\begin{aligned}\n   \\frac{\\partial{f}}{\\partial{x}} &= 8xz - 10xy \\\\\n   \\frac{\\partial{f}}{\\partial{y}} &= 6yz^2 - 5x^2 \\\\\n   \\frac{\\partial{f}}{\\partial{z}} &= 4x^2 + 6y^2z + 6z^2\n\\end{aligned}\n$$\n\nApply the implicit differentiation equation and substitute for the derivatives.\n\nCalculate the partial derivative of $z$ with respect to $x$.\n\n$$\n\\begin{aligned}\n   \\frac{\\partial{z}}{\\partial{x}} &= - \\frac{\\partial{f} / \\partial{x}}{\\partial{f} / \\partial{z}} \\\\\n   \\frac{\\partial{z}}{\\partial{x}} &= - \\frac{8xz - 10xy}{4x^2 + 6y^2z + 6z^2}\n\\end{aligned}\n$$\n\nCalculate the partial derivative of $z$ with respect to $y$.\n\n$$\n\\begin{aligned}\n   \\frac{\\partial{z}}{\\partial{y}} &= - \\frac{\\partial{f} / \\partial{y}}{\\partial{f} / \\partial{z}} \\\\\n   \\frac{\\partial{z}}{\\partial{y}} &= - \\frac{6yz^2 - 5x^2}{4x^2 + 6y^2z + 6z^2}\n\\end{aligned}\n$$\n:::\n\nImplicit differentiation allows you to find $\\dfrac{\\partial{z}}{\\partial{x}}$ and $\\dfrac{\\partial{z}}{\\partial{y}}$ without solving explicitly for $z$ which is often difficult or impossible to do.\n\nIt would be a lot harder to solve $4x^2 + 3y^2z^2 - 5x^2y + 2z^3 - 7 = 0$ for $z$ and then differentiate with respect to $x$ and $y$.\n\n# Quick check problems {.unnumbered}\n\n:::: {.content-visible when-format=\"html\"}\n::: {.webex-check .webex-box}\nConsider the function $w = f(x,y,z) = x^2y + 2xz + \\sin{(xy^2)}$ where $z=z(x,y)$ is defined implicitly.\n\nFill in the blanks of the derivatives required for the multivariate implicit differentiation equations.\n\nThe partial derivative of $z$ with respect to $x$ is $\\dfrac{\\partial{z}}{\\partial{x}} = -$ ___________________ $/$ _____\n\nThe partial derivative of $z$ with respect to $x$ is $\\dfrac{\\partial{z} }{\\partial{y}} = -$ ________________ $/$ _____\n:::\n::::\n\n::: {.content-hidden when-format=\"html\"}\nConsider the function $w = f(x,y,z) = x^2y + 2xz + \\sin{(xy^2)}$ where $z=z(x,y)$ is defined implicitly.\n\nFill in the blanks of the derivatives required for the multivariate implicit differentiation equations.\n\nThe partial derivative of $z$ with respect to $x$ is $\\dfrac{\\partial{z}}{\\partial{x}} = -$ ___________________ $/$ _____\n\nThe partial derivative of $z$ with respect to $x$ is $\\dfrac{\\partial{z} }{\\partial{y}} = -$ ________________ $/$ _____\n:::\n\n# Further reading\n\n[For more questions on the subject, please go to Questions: Multivariate implicit differentiation.](../questions/qs-multivariateimplicitdifferentiation.qmd)\n\n[For a way to consider derivatives with a defined direction, please see Guide: Directional derivatives.]\n\n## Version history {.unnumbered}\n\nv1.0: initial version created 05/25 by Donald Campbell as part of a University of St Andrews VIP project.\n\n[This work is licensed under CC BY-NC-SA 4.0.](https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}